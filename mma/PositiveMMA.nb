(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    130518,       3137]
NotebookOptionsPosition[    125338,       3038]
NotebookOutlinePosition[    125735,       3055]
CellTagsIndexPosition[    125692,       3052]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "PositiveMMA\n",
 StyleBox["High file for modules assisting with various maths and physics \
operations.\n",
  FontSize->18,
  FontColor->GrayLevel[0.5]],
 StyleBox["Lionel London (londonl@mit.edu) 2019",
  FontSize->18,
  FontColor->GrayLevel[0]]
}], "Title",
 CellChangeTimes->{{3.781092203859459*^9, 3.781092214622353*^9}, {
  3.781092260203877*^9, 3.781092294831913*^9}, {3.781099081026054*^9, 
  3.781099095567163*^9}},ExpressionUUID->"72372150-d4c7-42ff-8392-\
b19d75a3df08"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Notebooks", "[", "\"\<PositiveMMA.nb\>\"", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.694764343321434*^9, 3.694764348966854*^9}, {
  3.696327714548024*^9, 3.6963277146366568`*^9}, {3.781093066687624*^9, 
  3.781093068404831*^9}},ExpressionUUID->"3d04a2db-c585-49de-a815-\
9a3562c22593"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Begin Package",
 FontColor->GrayLevel[0.5]]], "Chapter",
 CellChangeTimes->{{3.781092222670632*^9, 3.781092248364132*^9}, {
  3.781092310240068*^9, 
  3.7810923130316143`*^9}},ExpressionUUID->"07fa5e09-6acf-47bd-b176-\
7a9735c3d040"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<PositiveMMA`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.781092344483083*^9, 3.7810923518720417`*^9}, {
  3.7810931034850483`*^9, 3.7810931038166103`*^9}, {3.7811077441604853`*^9, 
  3.781107744699312*^9}},ExpressionUUID->"b36b63d5-7fbf-4913-b87d-\
9f1d2673f37d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Package Body", "Chapter",
 CellChangeTimes->{{3.781092222670632*^9, 3.781092248364132*^9}, {
  3.781092310240068*^9, 3.7810923130316143`*^9}, {3.781107574498979*^9, 
  3.781107577383844*^9}},ExpressionUUID->"c3781337-bd75-44a2-9656-\
1a88b4a2aaa2"],

Cell[CellGroupData[{

Cell[TextData[{
 "Documentation\n",
 StyleBox["List package functions and describe basic usage.",
  FontSize->16,
  FontColor->GrayLevel[0.5]],
 StyleBox[" ",
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.780409120742175*^9, 3.780409212106798*^9}, {
  3.7810946464680243`*^9, 
  3.7810946627121687`*^9}},ExpressionUUID->"dcf14dd2-e66a-4719-9a9e-\
599c627b0684"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Method", " ", "to", " ", "relabel", " ", "index", " ", "of", " ", 
    "infinite", " ", "sum", " ", "such", " ", "that", " ", "there", " ", "is",
     " ", "no", " ", "external", " ", "power", " ", "explicit"}], " ", "*)"}],
   "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StandardizeSumPower", "::", "usage"}], "=", 
     "\"\<Given a single sum, write exponent relative to a single \
power\>\""}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Method", " ", "to", " ", "put", " ", "sum", " ", "prefector", " ", 
     "inside", " ", "sigma"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StandardizeSumTerm", "::", "usage"}], "=", 
     "\"\<Method to put sum prefector inside sigma\>\""}], ";"}], "\n", "\n", 
   
   RowBox[{"(*", " ", 
    RowBox[{
    "Method", " ", "to", " ", "standardize", " ", "all", " ", "terms", " ", 
     "in", " ", "multiple", " ", "sum", " ", "expression"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StandardizeSumTerms", "::", "usage"}], "=", 
     "\"\<Method to standardize all terms in multiple sum expression\>\""}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Given", " ", "a", " ", "sum", " ", "of", " ", "the", " ", "form", " ", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"n", "=", "0"}], "\[Infinity]"], 
       RowBox[{
        SuperscriptBox["\[Xi]", "n"], " ", 
        RowBox[{"d", "[", "n", "]"}]}]}]}], ",", " ", 
     RowBox[{
     "take", " ", "its", " ", "derivative", " ", "such", " ", "that", " ", 
      "the", " ", "correct", " ", "minimum", " ", "index", " ", "is", " ", 
      "used"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DerivativeOfSimpleSum", "::", "usage"}], "=", 
     "\"\<Given a sum of the form \!\(\*UnderoverscriptBox[\(\[Sum]\), \(n = \
0\), \(\[Infinity]\)]\)\!\(\*SuperscriptBox[\(\[Xi]\), \(n\)]\) d[n], take \
its derivative such that the correct minimum index is used\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Given", " ", "linear", " ", "differential", " ", "equation", " ", 
      "with", " ", "known", " ", "singular", " ", "points"}], ",", " ", 
     RowBox[{"determine", " ", "singular", " ", "exponents"}]}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"DeriveIndicialSolutions", "::", "usage"}], "=", 
    "\"\<Given linear differential equation with known singular points, \
determine singular exponents.\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Keep", " ", "largest", " ", "exponent", " ", "terms", " ", "in", " ", 
     "a", " ", "sum"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"TakeLargestExponent", "::", "usage"}], "=", 
    "\"\<Keep largest exponent terms in a sum\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Make", " ", "approximations", " ", "using", " ", "in", " ", "the", " ", 
     "WKB", " ", "way"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"WKBApproximate", "::", "usage"}], "=", 
    "\"\<Make approximations using in the WKB way\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Create", " ", "list", " ", "of", " ", "derivatives", " ", "up", " ", 
     "to", " ", "a", " ", "given", " ", "order"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"TableD", "::", "usage"}], "=", 
    "\"\<Create list of derivatives up to a given order\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Create", " ", "rule", " ", "to", " ", "replace", " ", "derivatives"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"MapRuleD", "::", "usage"}], "=", 
    "\"\<Create rule to replace derivatives\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "terms", " ", "independently"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"TermSimplify", "::", "usage"}], "=", 
    "\"\<Simplfy terms independently\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "terms", " ", "independently"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"TermFullSimplify", "::", "usage"}], "=", 
    "\"\<FullSimplfy terms independently\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "terms", " ", "independently"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"CoeffSimplify", "::", "usage"}], "=", 
    "\"\<Simplfy coefficients independently\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"FullSimplfy", " ", "terms", " ", "independently"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"CoeffFullSimplify", "::", "usage"}], "=", 
    "\"\<FullSimplfy terms independently\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "a", " ", "product", " ", "using", " ", "Log"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"LogSimplify", "::", "usage"}], "=", 
    "\"\<Simplfy a product using Log\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "terms", " ", "independently"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"CollectSimplify", "::", "usage"}], "=", 
    "\"\<Wrapper for CoeffSimplify\>\""}], "\n", 
   RowBox[{
    RowBox[{"CollectFullSimplify", "::", "usage"}], "=", 
    "\"\<Wrapper for CoeffFullSimplify\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Commutator", " ", "for", " ", "methods", " ", "with", " ", "one", " ", 
     "input"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Commutator", "::", "usage"}], "=", 
    "\"\<Commutator[A,B,Y] = (AB-BA)Y\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Given", " ", "a", " ", "Riccati", " ", "equation", " ", 
      RowBox[{"(", 
       RowBox[{
       "expressiion", " ", "that", " ", "hould", " ", "equal", " ", "zero"}], 
       ")"}]}], ",", " ", 
     RowBox[{"linearize", " ", "it"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"RiccatiLinearize", "::", "usage"}], "=", 
    "\"\<Given a Riccati equation (expressiion that hould equal zero), \
linearize it\>\""}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Method", " ", "to", " ", "compute", " ", "adjoint", " ", "of", " ", 
     "linear", " ", "differential", " ", "operator"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Adjoint", "::", "usage"}], "=", 
    "\"\<Method to compute adjoint of linear differential operator\>\""}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Elegant", " ", "function", " ", "to", " ", "return", " ", "python", " ", 
     "string", " ", "of", " ", "MMA", " ", "expressions"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"PythonForm", "::", "usage"}], "=", 
    "\"\<Elegant function to return python string of MMA expressions\>\""}], 
   "\n", 
   RowBox[{
    RowBox[{"PyForm", "::", "usage"}], "=", 
    "\"\<Elegant function to return python string of MMA expressions\>\""}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Method", " ", "to", " ", "determine", " ", "highest", " ", "derivative", 
     " ", "order", " ", "in", " ", "expression"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"MaxD", "::", "usage"}], "=", 
    "\"\<Method to determine highest derivative order in expression\>\""}], 
   "\n"}]}]], "Code",
 CellChangeTimes->{{3.781092421428199*^9, 3.7810925762749853`*^9}, {
   3.78109481213295*^9, 3.781094860987932*^9}, {3.78111659935882*^9, 
   3.781116626913004*^9}, {3.781299974624201*^9, 3.7813000125675583`*^9}, {
   3.781641100527299*^9, 3.781641141168405*^9}, {3.785327305072814*^9, 
   3.785327336608206*^9}, {3.785701098303645*^9, 3.785701122029151*^9}, {
   3.785701287379169*^9, 3.7857012878176622`*^9}, {3.785701421992694*^9, 
   3.785701450959231*^9}, {3.785761486214072*^9, 3.785761513948283*^9}, 
   3.785764804728904*^9, 3.7857648496088343`*^9, {3.7857665067491007`*^9, 
   3.7857665533200808`*^9}, {3.785874440719562*^9, 3.785874494276149*^9}, {
   3.786033935085294*^9, 3.786033944514893*^9}, {3.786034372844754*^9, 
   3.786034391923645*^9}, {3.7861670299656153`*^9, 3.7861670451203737`*^9}, 
   3.786167233343604*^9, {3.786167291384843*^9, 3.786167322246277*^9}, {
   3.7861687552052383`*^9, 3.786168759840369*^9}, {3.787770511533536*^9, 
   3.787770515873863*^9}, {3.787770570026997*^9, 3.787770576931797*^9}, 
   3.788771627166239*^9, {3.788823814397637*^9, 3.7888238422682867`*^9}, {
   3.7897378394780197`*^9, 3.789737853050477*^9}, {3.8310520806413307`*^9, 
   3.831052093539963*^9}, {3.83105383343429*^9, 
   3.831053839541547*^9}},ExpressionUUID->"16c5df31-db2a-44d9-93b4-\
ebd4591b3b4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define method to determine highest derivative order", "Subsubsection",
 CellChangeTimes->{{3.779892815636361*^9, 3.7798928900844603`*^9}, {
   3.780329480784194*^9, 3.780329481743114*^9}, {3.7804180890383577`*^9, 
   3.7804180893510027`*^9}, 3.780676227972101*^9, {3.781085215500752*^9, 
   3.781085217044408*^9}, {3.7811165810668793`*^9, 3.781116585137147*^9}, {
   3.789739106881792*^9, 
   3.789739113673232*^9}},ExpressionUUID->"833555dd-19bc-40f6-9291-\
07bcbdc947ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Method", " ", "to", " ", "determine", " ", "highest", " ", "derivative", 
    " ", "order", " ", "in", " ", "expression"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Remove", "[", "MaxD", "]"}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"MaxD", "[", 
     RowBox[{"Expression_", ",", "F_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Answer", ",", "Done", ",", "n", ",", "k", ",", "HasOrder", ",", 
        "ExpressionVars"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"ExpressionVars", " ", "=", " ", 
        RowBox[{"Variables", "[", "Expression", "]"}]}], ";", "\n", "\t", 
       RowBox[{"Answer", " ", "=", " ", "0"}], ";", " ", 
       RowBox[{"k", " ", "=", " ", "0"}], ";", "\n", "\t", 
       RowBox[{"Done", " ", "=", " ", "False"}], ";", "\n", "\t", 
       RowBox[{"While", "[", " ", 
        RowBox[{
         RowBox[{"!", "Done"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"HasOrder", " ", "=", " ", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"ExpressionVars", ",", 
             RowBox[{"D", "[", 
              RowBox[{"F", ",", 
               RowBox[{"{", 
                RowBox[{"var", ",", "k"}], "}"}]}], "]"}]}], "]"}]}], ";", 
          "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"HasOrder", ",", 
            RowBox[{"Answer", "=", "k"}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"Done", " ", "=", " ", 
           RowBox[{"!", "HasOrder"}]}], ";", "\n", "\t\t", 
          RowBox[{"k", "++"}]}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
       RowBox[{"Return", "[", "Answer", "]"}], ";"}]}], "\n", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.7897390993595037`*^9, 
  3.789739116297484*^9}},ExpressionUUID->"9b8b48ec-9a5a-4fbc-b402-\
6d58d1a95d27"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define method to keep largest exponent terms in a sum", "Subsubsection",
 CellChangeTimes->{{3.779892815636361*^9, 3.7798928900844603`*^9}, {
   3.780329480784194*^9, 3.780329481743114*^9}, {3.7804180890383577`*^9, 
   3.7804180893510027`*^9}, 3.780676227972101*^9, {3.781085215500752*^9, 
   3.781085217044408*^9}, {3.7811165810668793`*^9, 
   3.781116585137147*^9}},ExpressionUUID->"f1734a01-a6e4-40c1-8212-\
bd4f12f06e75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "TakeLargestExponent", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TakeLargestExponent", "[", 
   RowBox[{"Terms_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ans", ",", "MaxDeg", ",", "Terms2"}], "}"}], ",", "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Define", " ", "holder", " ", "for", " ", "output"}], " ", 
     "*)"}], "\n", "\t", 
    RowBox[{
     RowBox[{"Terms2", " ", "=", " ", "Terms"}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "largest", " ", "exponent"}], " ", "*)"}], "\n", 
     "\t", 
     RowBox[{"MaxDeg", " ", "=", " ", 
      RowBox[{"Max", "@", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{
           RowBox[{"Terms", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", "var"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "Terms", "]"}]}], "}"}]}], " ", "]"}]}]}], 
     ";", "\n", "\t", 
     RowBox[{"(*", " ", "*)"}], "\n", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Terms", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", "var"}], "]"}], " ", 
           "\[NotEqual]", " ", "MaxDeg"}], ",", "\[IndentingNewLine]", 
          "\t\t\t", 
          RowBox[{"(*", 
           RowBox[{"Remove", " ", "the", " ", "term"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Terms2", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "=", "0"}], ";"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], ";"}], "\[IndentingNewLine]", 
       "\t\t", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "Terms", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Terms", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Handle", " ", "constant", " ", "numerical", " ", "entries", " ", "in", 
       " ", "Terms"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Terms", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], " ", "\[Equal]", " ", 
           "0"}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{"(*", 
           RowBox[{"Remove", " ", "the", " ", "term"}], "*)"}], 
          "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Terms2", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "0"}], ";"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], ";"}], "\[IndentingNewLine]", 
       "\t\t", ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "Terms", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"Ans", " ", "=", " ", 
      RowBox[{"Simplify", "@", "Terms2"}]}], ";", "\n", "\t", 
     RowBox[{"Return", "[", "Ans", "]"}]}]}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.780493687934375*^9, 3.7804937590289097`*^9}, {
   3.780493810663756*^9, 3.780493824628603*^9}, {3.780493873992195*^9, 
   3.7804940232922773`*^9}, {3.7804940545887823`*^9, 3.780494166511806*^9}, {
   3.780494215422329*^9, 3.7804942158937397`*^9}, {3.780495135175046*^9, 
   3.7804953502475367`*^9}, {3.780495393677273*^9, 3.780495410482849*^9}, {
   3.780495503408022*^9, 3.7804955086160994`*^9}, 3.7806762509761477`*^9, {
   3.780676641901519*^9, 3.7806766767884493`*^9}, {3.780677302370841*^9, 
   3.780677315155814*^9}, {3.780677382886722*^9, 3.780677398701476*^9}, 
   3.7806782186668386`*^9, {3.780678252365258*^9, 3.780678273580976*^9}, {
   3.780678571848421*^9, 3.780678572895184*^9}, {3.780678627228024*^9, 
   3.780678674415041*^9}, {3.780678729734544*^9, 3.780678848767517*^9}, {
   3.781116995066164*^9, 3.7811170319930058`*^9}, {3.781117110613964*^9, 
   3.7811171839474573`*^9}, {3.781117223606112*^9, 3.7811172420828238`*^9}, {
   3.781171197560563*^9, 3.7811712007714367`*^9}, {3.781171235633211*^9, 
   3.781171266892643*^9}},ExpressionUUID->"3d39f39d-97e2-4e24-bb4c-\
2d424448d601"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define useful methods for sum manipulations\n",
 StyleBox["Put sums into a form that facilitates derivation of the recursion \
relations",
  FontSize->16,
  FontColor->GrayLevel[0.5]],
 StyleBox[" ",
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.780409120742175*^9, 
  3.780409212106798*^9}},ExpressionUUID->"ceaff881-3ce5-4412-8f2d-\
ac5488657115"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Method", " ", "to", " ", "relabel", " ", "index", " ", "of", " ", 
    "infinite", " ", "sum", " ", "such", " ", "that", " ", "there", " ", "is",
     " ", "no", " ", "external", " ", "power", " ", "explicit"}], " ", "*)"}],
   "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Remove", "[", "StandardizeSumPower", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"StandardizeSumPower", "[", 
     RowBox[{"SumPart_", ",", 
      RowBox[{"var_:", "v"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Ans", ",", "NewSumPart", ",", "OldPwr", ",", "OldDex", ",", 
        "OldMinDex", ",", "OldMaxDex", ",", "NewDex", ",", "\n", "\t", 
        "NewSumPart1", ",", "NewSumPart2", ",", "NewMinDex", ",", "NewMaxDex",
         ",", "OldDexRule"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Extract", " ", "Info", " ", "from", " ", "Sum"}], " ", "*)"}],
       "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"OldDex", ",", "OldMinDex", ",", "OldMaxDex"}], "}"}], " ", 
        "=", " ", 
        RowBox[{"SumPart", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"OldPwr", " ", "=", " ", 
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"SumPart", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "var"}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"NewSumPart", " ", "=", " ", "SumPart"}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", " ", "needed"}], ",", " ", 
         RowBox[{"adjust", " ", "labels", " ", "and", " ", "limits"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"OldPwr", "\[Equal]", "OldDex"}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Do", " ", "Nothing"}], " ", "*)"}], "\n", "\t\t", 
         RowBox[{"Ans", " ", "=", " ", "SumPart"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Do", " ", "Things"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{
          RowBox[{"OldDexRule", " ", "=", " ", 
           RowBox[{
            RowBox[{"Solve", "[", "  ", 
             RowBox[{
              RowBox[{"NewDex", " ", "\[Equal]", " ", "OldPwr"}], ",", " ", 
              "OldDex"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"NewSumPart1", " ", "=", " ", 
           RowBox[{
            RowBox[{"SumPart", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", "OldDexRule"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"NewMinDex", " ", "=", " ", 
           RowBox[{"OldMinDex", "+", "OldPwr", "-", "OldDex"}]}], ";", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"NewMaxDex", " ", "=", " ", 
           RowBox[{"OldMaxDex", "+", "OldPwr", "-", "OldDex"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Only", " ", "works", " ", "for", " ", "infinite", " ", "sums", 
            " ", 
            RowBox[{"anyway", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\t\t", 
          RowBox[{"NewSumPart2", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"NewDex", ",", "NewMinDex", ",", "NewMaxDex"}], "}"}]}], 
          ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"NewSumPart", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "NewSumPart1"}], 
          ";", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"NewSumPart", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "NewSumPart2"}], 
          ";", "\n", "\t\t", 
          RowBox[{"Ans", " ", "=", " ", 
           RowBox[{"NewSumPart", "/.", 
            RowBox[{"{", 
             RowBox[{"NewDex", "\[Rule]", "OldDex"}], "}"}]}]}], ";"}]}], 
        "\n", "\t", "]"}], ";", "\n", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Method", " ", "to", " ", "put", " ", "sum", " ", "prefector", " ", 
     "inside", " ", "sigma"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "StandardizeSumTerm", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StandardizeSumTerm", "[", 
     RowBox[{"Term_", ",", 
      RowBox[{"var_:", "v"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Ans", ",", "SumPart", ",", "PreFact", " ", ",", "NewSumPart", ",", 
        "NewPreFact", ",", "Limits", ",", "Pwr", ",", "OldDex", ",", 
        "NewDex"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"SumPart", " ", "=", " ", 
        RowBox[{"Term", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"PreFact", " ", "=", " ", 
        RowBox[{"Term", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"NewSumPart", " ", "=", " ", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"SumPart", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "PreFact"}], "]"}]}], ";", 
       " ", 
       RowBox[{"NewPreFact", " ", "=", "  ", "1"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Ans", " ", "=", " ", "Term"}], ";", " ", 
       RowBox[{"Limits", " ", "=", " ", 
        RowBox[{"SumPart", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Ans", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "NewSumPart"}], ";", 
       " ", 
       RowBox[{
        RowBox[{"Ans", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}], " ", "=", " ", "NewPreFact"}], 
       ";", "\n", "\t", 
       RowBox[{"Limits", " ", "=", " ", 
        RowBox[{
         RowBox[{"Ans", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Standardize", " ", "power", " ", "label"}], " ", "*)"}], 
       "\n", "\t", 
       RowBox[{"Ans", " ", "=", " ", 
        RowBox[{"StandardizeSumPower", "[", 
         RowBox[{"Ans", ",", "var"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Term", ",", "\"\<  -->  \>\"", ",", "Ans"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Method", " ", "to", " ", "standardize", " ", "all", " ", "terms", " ", 
     "in", " ", "multiple", " ", "sum", " ", "expression"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Remove", "[", "StandardizeSumTerms", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StandardizeSumTerms", "[", 
     RowBox[{"Terms_", ",", 
      RowBox[{"var_:", "v"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ans", ",", "ExpandedTerms"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"ExpandedTerms", " ", "=", " ", 
        RowBox[{"Expand", "@", "Terms"}]}], ";", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"Ans", " ", "=", " ", "ExpandedTerms"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Ans", "[", 
            RowBox[{"[", "INDEX", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"StandardizeSumTerm", "[", 
            RowBox[{
             RowBox[{"ExpandedTerms", "[", 
              RowBox[{"[", "INDEX", "]"}], "]"}], ",", "var"}], "]"}]}], 
          ";"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"INDEX", ",", 
           RowBox[{"Length", "[", "ExpandedTerms", "]"}]}], "}"}]}], " ", 
        "]"}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Given", " ", "a", " ", "sum", " ", "of", " ", "the", " ", "form", " ", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"n", "=", "0"}], "\[Infinity]"], 
       RowBox[{
        SuperscriptBox["\[Xi]", "n"], " ", 
        RowBox[{"d", "[", "n", "]"}]}]}]}], ",", " ", 
     RowBox[{
     "take", " ", "its", " ", "derivative", " ", "such", " ", "that", " ", 
      "the", " ", "correct", " ", "minimum", " ", "index", " ", "is", " ", 
      "used"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "DerivativeOfSimpleSum", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"DerivativeOfSimpleSum", "[", 
     RowBox[{"S_", ",", 
      RowBox[{"DInputs_:", "None"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Answer", ",", "RawDS", ",", "Order", ",", "dex", ",", "min", ",", 
        "max", ",", "var", ",", "MinDex"}], "}"}], ",", "\n", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Determine", " ", "the", " ", "correct", " ", "minimum", " ", 
        "index"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"RawDS", " ", "=", " ", 
        RowBox[{"D", "[", 
         RowBox[{"S", ",", "DInputs"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dex", ",", "min", ",", "max"}], "}"}], " ", "=", " ", 
        RowBox[{"S", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"var", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{"dex", " ", "\[Rule]", "1"}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "[", "1", "]"}], "\[Rule]", "1"}], "}"}]}]}], ";", 
       "\n", "\t", 
       RowBox[{"Order", " ", "=", " ", 
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"RawDS", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "var"}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"MinDex", " ", "=", " ", 
        RowBox[{"dex", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"Order", "\[Equal]", "0"}], ",", "dex"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Apply", " ", "the", " ", "correct", " ", "minimum", " ", "index", 
         " ", "to", " ", "the", " ", "sum"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"Answer", " ", "=", " ", "RawDS"}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Answer", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "MinDex"}], ";", "\n",
        "\n", "\t", 
       RowBox[{"(*", " ", "Return", " ", "*)"}], "\n", "\t", 
       RowBox[{"Return", "[", "Answer", "]"}], ";"}]}], "\n", "\n", "]"}]}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Simplify", " ", "coefficients", " ", "of", " ", "power", " ", 
      "expansion", " ", "in", " ", "select", " ", "variable"}], " ", "*)"}], 
    "\n", 
    RowBox[{
     RowBox[{"Remove", "[", "CoeffSimplify", "]"}], ";", "\n", 
     RowBox[{
      RowBox[{"CoeffSimplify", "[", 
       RowBox[{"A_", ",", "var_"}], "]"}], ":=", 
      RowBox[{"Module", "[", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Define", " ", "Internal", " ", "Vars"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "ans", ",", "MaxPow", ",", "A1", ",", "A2", ",", "A3", ",", 
          "Coeffs"}], "}"}], ",", "\n", "\t", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Determine", " ", "Max", " ", "Power", " ", "in", " ", "desired", 
          " ", "variable"}], " ", "*)"}], "\n", "\t", 
        RowBox[{
         RowBox[{"MaxPow", " ", "=", " ", 
          RowBox[{"Exponent", "[", 
           RowBox[{"A", ",", "var"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Find", " ", "corresponding", " ", "Series", " ", "Expansion"}], 
          " ", "*)"}], "\n", "\t", 
         RowBox[{"A1", " ", "=", " ", 
          RowBox[{"Normal", "@", 
           RowBox[{"Series", "[", 
            RowBox[{"A", ",", 
             RowBox[{"{", 
              RowBox[{"var", ",", "0", ",", 
               RowBox[{"MaxPow", "+", "1"}]}], "}"}]}], "]"}]}]}], ";", "\n", 
         "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"FullSimplify", " ", "each", " ", "term"}], " ", "*)"}], 
         "\n", "\t", 
         RowBox[{"A2", " ", "=", " ", "A1"}], ";", "\n", "\t", 
         RowBox[{"Coeffs", " ", "=", " ", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{"A1", ",", "var"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"A2", " ", "=", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{"Coeffs", "[", 
               RowBox[{"[", "k", "]"}], "]"}], " ", 
              SuperscriptBox["var", 
               RowBox[{"k", "-", "1"}]]}], " ", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"MaxPow", "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"ans", " ", "=", " ", 
          RowBox[{"FullSimplify", "[", "A2", "]"}]}], ";", "\n", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{"Return", " ", "Answer"}], " ", "*)"}], "\n", "\t", 
         RowBox[{"Return", "[", "ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "*)"}]}]}]], "Code",
 CellChangeTimes->{{3.78040011783011*^9, 3.7804001837179537`*^9}, {
   3.780400243440284*^9, 3.780400378199896*^9}, {3.7804004440970087`*^9, 
   3.780400489025104*^9}, {3.780400520105068*^9, 3.78040056907869*^9}, {
   3.780401511129455*^9, 3.780401597110223*^9}, {3.78040165263501*^9, 
   3.780401673823728*^9}, {3.780401707329047*^9, 3.7804017518371363`*^9}, {
   3.780401782906988*^9, 3.780401783296471*^9}, 3.7804018579931927`*^9, {
   3.780403461096224*^9, 3.780403618351141*^9}, {3.780403676975561*^9, 
   3.780403682236927*^9}, {3.78040375057763*^9, 3.7804038269693403`*^9}, {
   3.780404016442086*^9, 3.7804040201598063`*^9}, {3.78040409667327*^9, 
   3.780404118771873*^9}, {3.780404159093163*^9, 3.780404230800856*^9}, {
   3.780404269049389*^9, 3.7804043022767878`*^9}, {3.780404337363665*^9, 
   3.780404357779711*^9}, {3.7804043891791763`*^9, 3.780404433210793*^9}, {
   3.780404464825295*^9, 3.780404523081561*^9}, {3.780404567024109*^9, 
   3.7804047190746613`*^9}, {3.780404841315119*^9, 3.780404926047678*^9}, {
   3.780404960144327*^9, 3.780404970353566*^9}, {3.780405010309578*^9, 
   3.7804050814592333`*^9}, {3.7804065475529337`*^9, 
   3.7804065706299677`*^9}, {3.780406607517065*^9, 3.7804067934315643`*^9}, {
   3.7804068555228*^9, 3.780406898691839*^9}, {3.7804082540214043`*^9, 
   3.78040867377323*^9}, {3.7804087051102743`*^9, 3.780408705487316*^9}, 
   3.780408782374208*^9, {3.780408917408231*^9, 3.780408944267138*^9}, {
   3.780408983463553*^9, 3.78040902383858*^9}, 3.780409064087441*^9, 
   3.780409558322008*^9, 3.781097621952824*^9, 3.781097657384893*^9, 
   3.781097700263085*^9, {3.7816410106213293`*^9, 3.781641022727788*^9}, {
   3.781641062548871*^9, 3.781641086250175*^9}, 3.781641188175497*^9, {
   3.785327354006309*^9, 3.785327366314816*^9}, 3.785332174683127*^9, 
   3.788771654777763*^9},ExpressionUUID->"8b7f6a42-345a-4a43-9032-\
4ff4c8235c69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define method to determine singular exponents for linear differential \
equations\n",
 StyleBox["Assumes singular points are known",
  FontSize->16,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.779892815636361*^9, 3.7798928900844603`*^9}, {
   3.780329480784194*^9, 3.780329481743114*^9}, {3.7804180890383577`*^9, 
   3.7804180893510027`*^9}, 3.780676227972101*^9, {3.781085215500752*^9, 
   3.781085217044408*^9}, {3.781085276480856*^9, 3.781085286949916*^9}, {
   3.7810947625000267`*^9, 3.781094793044289*^9}, {3.781094920175769*^9, 
   3.7810949308885202`*^9}},ExpressionUUID->"04528f97-b046-47bc-8df6-\
6764c783d45f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "DeriveIndicialSolutions", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DeriveIndicialSolutions", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"PreScale", "\[Rule]", "1"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DeriveIndicialSolutions", "[", 
   RowBox[{"Dy_", ",", "y_", ",", "x_", ",", "SingularPoints_", ",", 
    RowBox[{"order_:", "2"}], ",", 
    RowBox[{"f_:", "f"}], ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", "\[IndentingNewLine]", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"Internal", " ", "variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ans", ",", "SingularScale", ",", "xSingular", ",", "SingularIndex", ",",
       "xRef", ",", "IndicialSolution", ",", "\[IndentingNewLine]", "\t", 
      "yTest", ",", "yDelta", ",", "TestDy", ",", "IndicialPolynomial", ",", 
      "g", ",", "IndEqnK", ",", "SingularExponent"}], "}"}], ",", "\n", "\t", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
     "Determine", " ", "a", " ", "singular", " ", "scaling", " ", "for", " ", 
      "the", " ", "solution", " ", "ansatz"}], "*)"}], "\[IndentingNewLine]", 
    "\t", 
    RowBox[{
     RowBox[{"SingularScale", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "PreScale", "]"}]}], ";", " ", 
     RowBox[{"SingularIndex", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", " ", 
     RowBox[{"yDelta", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Create", " ", "expressions", " ", "for", " ", "singular", " ", 
        "indices"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"SingularIndex", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"SingularIndex", ",", 
           RowBox[{"{", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<k\>\"", "<>", 
              RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Construct", " ", "singular", " ", "scaling", " ", "based", " ", 
          "on", " ", "singular", " ", "points", " ", "and", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"xSingular", " ", "=", " ", 
         RowBox[{"SingularPoints", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"SingularScale", " ", "=", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "xSingular"}], ")"}], 
           RowBox[{"SingularIndex", "[", 
            RowBox[{"[", "k", "]"}], "]"}]], "SingularScale"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"yDelta", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "xSingular"}], ")"}], " ", "yDelta"}]}], ";"}], 
       "\[IndentingNewLine]", "\t\t", ",", " ", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "SingularPoints", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\n", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Write", " ", "series", " ", "solution", " ", "ansatz"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"xRef", " ", "=", " ", 
      RowBox[{"SingularPoints", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "k", "]"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "xRef"}], " ", ")"}], "k"]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", "order"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"yTest", " ", "=", " ", 
      RowBox[{"SingularScale", " ", "g"}]}], ";", "\n", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Apply", " ", "ansatz"}], ",", " ", 
       RowBox[{
       "and", " ", "then", " ", "determine", " ", "indicial", " ", 
        "polynomial"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"TestDy", " ", "=", " ", 
      RowBox[{"Dy", "/.", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"y", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "k"}], "}"}]}], "]"}], "\[Rule]", 
          RowBox[{"D", "[", 
           RowBox[{"yTest", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "k"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "order"}], "}"}]}], "]"}]}]}], ";", 
     "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "Indicial", " ", "Polynomial", " ", "is", " ", "determine", 
       " ", "by", " ", "enforcing", " ", "that", " ", "the", " ", "\n", "\t", 
       "solution", " ", "is", " ", "regular", " ", "at", " ", "the", " ", 
       "singular", " ", 
       RowBox[{"points", ".", " ", "This"}], " ", "is", " ", "equivalent", 
       " ", "\n", "\t", "to", " ", "enforcing", " ", "that", " ", "the", " ", 
       "leading", " ", "coefficient", " ", "of", " ", "the", " ", 
       RowBox[{"solution", "'"}], "s", " ", "series", "\n", "\t", "expansion",
        " ", "is", " ", "zero", " ", "at", " ", "the", " ", "singular", " ", 
       RowBox[{"points", ".", " ", "This"}], " ", "latter", " ", "condition", 
       " ", "\n", "\t", "yields", " ", "the", " ", "indicial", " ", 
       "equation", 
       RowBox[{
        RowBox[{"(", "s", ")"}], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"IndicialPolynomial", " ", "=", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"(", 
         FractionBox["yDelta", "SingularScale"], ")"}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"TestDy", ",", 
          RowBox[{"a", "[", "0", "]"}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
     "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Solve", " ", "indicial", " ", "equation", " ", "at", " ", "evenery", 
       " ", "singular", " ", "point"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"SingularExponent", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"xSingular", " ", "=", " ", 
         RowBox[{"SingularPoints", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"IndEqnK", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"IndicialPolynomial", "/.", 
            RowBox[{"{", 
             RowBox[{"x", " ", "\[Rule]", " ", "xSingular"}], "}"}]}], ")"}], 
          "\[Equal]", "0"}]}], ";", "\n", "\t\t", 
        RowBox[{"IndicialSolution", " ", "=", " ", 
         RowBox[{"Solve", "[", " ", 
          RowBox[{"IndEqnK", ",", " ", 
           RowBox[{"SingularIndex", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"SingularExponent", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"SingularExponent", ",", 
           RowBox[{"{", "IndicialSolution", "}"}]}], "]"}]}], ";"}], "\n", 
       "\t\t", ",", " ", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "SingularPoints", "]"}]}], "}"}]}], "\n", 
      "\t", "]"}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", 
       RowBox[{"answer", ":", " ", 
        RowBox[{
        "The", " ", "singular", " ", "exponents", " ", "and", " ", "the", " ",
          "singular", " ", "scale", " ", "function", " ", "and", " ", 
         "associated", " ", "Delta", " ", "quantity"}]}]}], " ", "*)"}], "\n",
      "\t", 
     RowBox[{"Ans", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "SingularExponent", "}"}], ",", 
        RowBox[{"{", " ", 
         RowBox[{"SingularScale", " ", 
          RowBox[{"f", "[", "x", "]"}]}], " ", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.7810853011579742`*^9, 3.781085422713533*^9}, {
   3.781085454119693*^9, 3.7810855671091967`*^9}, {3.7810862452263803`*^9, 
   3.7810864442762012`*^9}, {3.781086481699547*^9, 3.781086529126436*^9}, {
   3.781086592319446*^9, 3.781086646928433*^9}, {3.7810866951765347`*^9, 
   3.78108680023033*^9}, {3.7810868576336393`*^9, 3.781086929896468*^9}, {
   3.781088460090927*^9, 3.781088502033258*^9}, {3.7810892205405807`*^9, 
   3.781089232673613*^9}, {3.78108942774153*^9, 3.781089753325335*^9}, {
   3.7810898681833*^9, 3.7810900469379997`*^9}, 3.7810901289189997`*^9, {
   3.781090202969304*^9, 3.781090412427932*^9}, {3.781090442637827*^9, 
   3.781090613163868*^9}, {3.781090655866542*^9, 3.781090852035535*^9}, {
   3.781090987152644*^9, 3.781091091331365*^9}, {3.7810952681398077`*^9, 
   3.7810952938854923`*^9}, {3.781097455100651*^9, 3.781097459307747*^9}, {
   3.781097632492154*^9, 3.781097637136263*^9}, {3.781097711703457*^9, 
   3.7810977156034184`*^9}, {3.781098219854949*^9, 3.7810982579913597`*^9}, {
   3.781098294999587*^9, 3.7810983210546007`*^9}, {3.781098415149044*^9, 
   3.781098421541729*^9}, {3.781098584817009*^9, 3.781098592566699*^9}, {
   3.781098761397975*^9, 3.7810987649310226`*^9}, {3.781098824052346*^9, 
   3.781098834068637*^9}, {3.7810988711513653`*^9, 3.781098887044615*^9}, 
   3.7811099603519506`*^9, {3.7811892201839314`*^9, 3.781189275414238*^9}, {
   3.7811893577521057`*^9, 3.781189359672306*^9}, {3.781189502656252*^9, 
   3.781189573468916*^9}, {3.7811896371214933`*^9, 
   3.781189643941896*^9}},ExpressionUUID->"4162d819-5a67-484b-afa7-\
1f25f25369ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define alternative method to determine singular exponents for linear \
differential equations of the generalised spheroidal form\n",
 StyleBox["This is to be used as a check for the more common method",
  FontSize->16,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.779892815636361*^9, 3.7798928900844603`*^9}, {
   3.780329480784194*^9, 3.780329481743114*^9}, {3.7804180890383577`*^9, 
   3.7804180893510027`*^9}, 3.780676227972101*^9, {3.781085215500752*^9, 
   3.781085217044408*^9}, {3.781085276480856*^9, 3.781085286949916*^9}, {
   3.7810947625000267`*^9, 3.781094793044289*^9}, {3.781094920175769*^9, 
   3.781094977128558*^9}},ExpressionUUID->"62dc2d50-452c-41f9-8ddb-\
d9bd0e6a7bd8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "DeriveIndicialSolutions2", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DeriveIndicialSolutions2", "[", 
   RowBox[{
   "DyFunctions_", ",", "y_", ",", "x_", ",", "SingularPoints_", ",", 
    RowBox[{"f_:", "f"}], ",", 
    RowBox[{"RefDy_:", "None"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", "\t", "\n", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"Internal", " ", "variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ans", ",", "p", ",", "SingularScale", ",", "xSingular", ",", 
      "SingularIndex", ",", "IndicialSolution", ",", "Dy", ",", 
      "IndicialEquation", ",", "\[IndentingNewLine]", "\t", "A", ",", "B", 
      ",", "C1", ",", "C2", ",", "Delta", ",", "V", ",", "IndEqnK", ",", 
      "SingularExponent", ",", "TestDy", ",", "yTest", ",", "xRef", ",", 
      "Df"}], "}"}], ",", "\n", "\t", "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Check", " ", "for", " ", "correct", " ", "1", "st", " ", "input", " ", 
      "format"}], " ", "*)"}], "\n", "\t", 
    RowBox[{
     RowBox[{"Catch", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"4", "==", 
           RowBox[{"Length", "[", "DyFunctions", "]"}]}], "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"(*", " ", "Unpack", " ", "*)"}], "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"A", ",", "B", ",", "C1", ",", "C2"}], "}"}], " ", "=", 
           " ", "DyFunctions"}], ";"}], "\n", "\t\t\t", ",", " ", 
         RowBox[{"(*", " ", "Otherwise", " ", "*)"}], "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<\n\t\t\t\tERROR: The first input should be a table of 4 \
functions of the dependent variable. \n\t\t\t\tThese functions, {A,B,C1,C2}, \
should correspond to a differential equation of the form\n\t\t\t\t\
------------------------------------------------------------------------------\
----------\n\t\t\t\tDy = (C1[x]+\!\(\*FractionBox[\(C2[x]\), \(Delta[x]\)]\)) \
y[x]+B[x] \!\(\*SuperscriptBox[\"y\", \
\"\[Prime]\",MultilineFunction->None]\)[x]+Delta[x] A[x] \
\!\(\*SuperscriptBox[\"y\", \
\"\[Prime]\[Prime]\",MultilineFunction->None]\)[x]\n\t\t\t\t\
------------------------------------------------------------------------------\
----------\n\t\t\t\tWhere Delta[x] is the product of x minus all singular \
pionts: (x-x1)(x-x2)...(x-xN).\n\t\t\t\>\"", "]"}], ";", "\n", "\t\t\t", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "]"}], ";"}]}], "\n", "\t\t", 
        "]"}], ";"}], "\n", "\t", "]"}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Use", " ", "DyFunctions", " ", "to", " ", "construct", " ", "the", " ",
        "differential", " ", "equation"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"Delta", " ", "=", " ", "1"}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"xSingular", " ", "=", " ", 
         RowBox[{"SingularPoints", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"Delta", " ", "=", " ", 
         RowBox[{"Delta", " ", 
          RowBox[{"(", 
           RowBox[{"x", "-", "xSingular"}], ")"}]}]}], ";"}], "\n", "\t\t", 
       ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "SingularPoints", "]"}]}], "}"}]}], "\n", 
      "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Define", " ", "a", " ", "list", " ", "containing", " ", "the", " ", 
       "coefficitents", " ", "of", " ", "the", " ", "defferential", " ", 
       "equation"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"{", "  ", 
       RowBox[{
        RowBox[{"C1", "+", 
         FractionBox["C2", "Delta"]}], ",", " ", "B", ",", " ", 
        RowBox[{"Delta", " ", "A"}]}], " ", "}"}]}], ";", "\n", "\t", "\n", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Construct", " ", "the", " ", "differential", " ", "equation"}],
       " ", "*)"}], "\n", "\t", 
     RowBox[{"Dy", " ", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"[", "k", "]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"y", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\t", "\n", "\t", 
     RowBox[{"(*", "*)"}], "\n", "\t", 
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{"RefDy", " ", "=!=", " ", "None"}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Print", "[", "Dy", "]"}], ";", "\n", "\t\t", 
        RowBox[{"Print", "[", "RefDy", "]"}], ";", "\n", "\t\t", 
        RowBox[{"Print", "[", " ", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Dy", "\[Equal]", "RefDy"}], "]"}], " ", "]"}], ";"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "a", " ", "singular", " ", "scaling", " ", "for", " ",
        "the", " ", "solution", " ", "ansatz"}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"SingularScale", " ", "=", " ", "1"}], ";", " ", 
     RowBox[{"SingularIndex", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Create", " ", "expressions", " ", "for", " ", "singular", " ", 
        "indices"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"SingularIndex", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"SingularIndex", ",", 
           RowBox[{"{", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<k\>\"", "<>", 
              RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Construct", " ", "singular", " ", "scaling", " ", "based", " ", 
          "on", " ", "singular", " ", "points", " ", "and", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
        RowBox[{"xSingular", " ", "=", " ", 
         RowBox[{"SingularPoints", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{"SingularScale", " ", "=", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", "xSingular"}], ")"}], 
           RowBox[{"SingularIndex", "[", 
            RowBox[{"[", "k", "]"}], "]"}]], "SingularScale"}]}], ";"}], 
       "\[IndentingNewLine]", "\t\t", ",", " ", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "SingularPoints", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "test", " ", "ansatz", " ", "to", " ", "differential", 
       " ", "equation"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"yTest", " ", "=", " ", 
      RowBox[{"SingularScale", " ", 
       RowBox[{"f", "[", "x", "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"TestDy", " ", "=", " ", 
      RowBox[{"Simplify", "[", "\n", "\t\t\t\t", 
       RowBox[{"Dy", "  ", "/.", "  ", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"y", "[", "x", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], "\[Rule]", " ", 
           RowBox[{"D", "[", 
            RowBox[{"yTest", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], " ", "]"}]}], "\n", 
       "\t\t\t ", "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Derive", " ", "indicial", " ", "polynomial"}], " ", "*)"}], 
     "\n", "\t", 
     RowBox[{"Df", " ", "=", " ", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"(", 
           FractionBox["Delta", "SingularScale"], ")"}], "TestDy"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox["f", "\[Prime]",
            MultilineFunction->None], "[", "x", "]"}], ",", 
          RowBox[{"f", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Simplify", "@", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"Df", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", "x", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Length", "[", "p", "]"}]}], "}"}]}], "]"}]}], "]"}]}]}],
      ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "We", " ", "wish", " ", "to", " ", "define", " ", "the", " ", 
        "trasformed", " ", "potential"}], ",", " ", 
       RowBox[{"V", " ", "=", " ", 
        RowBox[{"p", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{
       "so", " ", "that", " ", "it", " ", "is", " ", "zero", "\n", "\t   ", 
        "at", " ", "the", " ", "singular", " ", 
        RowBox[{"points", "."}]}]}], " ", "*)"}], "\n", "\t", 
     RowBox[{"V", " ", "=", " ", 
      RowBox[{"p", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Solve", " ", "indicial", " ", "equation", " ", "at", " ", "evenery", 
       " ", "singular", " ", "point"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"SingularExponent", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t", 
     RowBox[{"IndicialEquation", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"xSingular", " ", "=", " ", 
         RowBox[{"SingularPoints", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"IndEqnK", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", "/.", 
            RowBox[{"{", 
             RowBox[{"x", " ", "\[Rule]", " ", "xSingular"}], "}"}]}], ")"}], 
          "\[Equal]", "0"}]}], ";", "\n", "\t\t", 
        RowBox[{"IndicialSolution", " ", "=", " ", 
         RowBox[{"Solve", "[", " ", 
          RowBox[{"IndEqnK", ",", " ", 
           RowBox[{"SingularIndex", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"SingularExponent", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"SingularExponent", ",", 
           RowBox[{"{", "IndicialSolution", "}"}]}], "]"}]}], ";"}], "\n", 
       "\t\t", ",", " ", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "SingularPoints", "]"}]}], "}"}]}], "\n", 
      "\t", "]"}], ";", "\n", "\t", "\n", "\t", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", "answer"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"Ans", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "SingularExponent", "}"}], ",", 
        RowBox[{"{", " ", 
         RowBox[{"SingularScale", " ", 
          RowBox[{"f", "[", "x", "]"}]}], " ", "}"}]}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\n", "\t", "\n", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.781095106636739*^9, 3.781095159744948*^9}, {
   3.781095215238183*^9, 3.781095263882759*^9}, {3.7810952983077517`*^9, 
   3.781095304886608*^9}, 3.781097462737707*^9, 3.781097641786693*^9, 
   3.781097719930666*^9, {3.781107907486519*^9, 3.78110810716321*^9}, {
   3.781108183076395*^9, 3.7811084476785793`*^9}, {3.781108491877413*^9, 
   3.7811085709868517`*^9}, {3.781108610156732*^9, 3.781108684352477*^9}, {
   3.7811087413242493`*^9, 3.781108971530943*^9}, {3.781109006098374*^9, 
   3.781109391248768*^9}, {3.781109477686459*^9, 3.781109487849537*^9}, {
   3.78110969169279*^9, 3.78110982896628*^9}, {3.7811098648854628`*^9, 
   3.781109926751849*^9}, {3.781109967995974*^9, 3.781109968254223*^9}, {
   3.781110338395526*^9, 3.781110382169025*^9}, {3.78111044490082*^9, 
   3.781110456991126*^9}, {3.78111049472652*^9, 3.781110510980339*^9}, 
   3.781110617806975*^9, {3.781110735405053*^9, 3.781110787368004*^9}, {
   3.781110817389861*^9, 3.781110832356761*^9}, 3.781110959585128*^9, {
   3.78111105022771*^9, 3.781111077612563*^9}, {3.781111162667506*^9, 
   3.781111170464575*^9}, 3.781111266335363*^9, {3.7811112965860662`*^9, 
   3.781111302836584*^9}, {3.781111346437407*^9, 3.7811113641525927`*^9}, {
   3.781111428776067*^9, 3.781111461181901*^9}, {3.781788663871994*^9, 
   3.781788686429513*^9}, {3.83192723228025*^9, 3.831927327317259*^9}, {
   3.831927402872864*^9, 3.8319274042056847`*^9}, 
   3.8319274399974737`*^9},ExpressionUUID->"4d4f4b0a-5c81-4d62-b355-\
af83b820b66e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "String manipulation and output\n",
 StyleBox["s Useful for transferring MMA results to e.g. Python",
  FontSize->16,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.7877704428700123`*^9, 3.787770452319893*^9}, {
  3.787770523930872*^9, 
  3.787770559922676*^9}},ExpressionUUID->"e33c1268-3682-417e-8027-\
e9b0c5785118"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Remove", "[", 
    RowBox[{"PythonForm", ",", "PyForm"}], "]"}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Elegant", " ", "function", " ", "to", " ", "return", " ", "python", " ", 
    "string", " ", "of", " ", "MMA", " ", "expressions"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PythonForm", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", "Answer", "}"}], ",", "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"Handle", " ", "complex", " ", "numbers"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "A", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<^\>\"", "\[Rule]", "\"\<**\>\""}], ",", 
          RowBox[{"\"\<I\>\"", "\[Rule]", "\"\<1j\>\""}]}], "}"}]}], "]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", "Pi"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<pi\>\""}], "}"}]}], "]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"Exp", "[", "X", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<E**\>\"", "\[Rule]", "\"\<exp\>\""}], "}"}]}], "]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"Floor", "[", "X", "]"}]}], " ", "*)"}], "\[IndentingNewLine]",
      "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Floor\>\"", "\[Rule]", "\"\<floor\>\""}], "}"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"Arg", "[", "X", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Arg\>\"", "\[Rule]", "\"\<angle\>\""}], "}"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"Abs", "[", "X", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Abs\>\"", "\[Rule]", "\"\<abs\>\""}], "}"}]}], "]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"Sign", "[", "X", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sign\>\"", "\[Rule]", "\"\<sign\>\""}], "}"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"Sqrt", "[", "X", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], "}"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"ArcTanh", "[", "X", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<ArcTanh\>\"", "\[Rule]", "\"\<arctanh\>\""}], "}"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"ArcCos", "[", "X", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<ArcCos\>\"", "\[Rule]", "\"\<arccos\>\""}], "}"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", 
       RowBox[{"Tanh", "[", "X", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Tanh\>\"", "\[Rule]", "\"\<tanh\>\""}], "}"}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", "[", " ", "and", " ", "]"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
          RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}]}], "}"}]}], "]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Handle", " ", "division"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"Answer", ",", 
        RowBox[{"{", 
         RowBox[{"\"\</\>\"", "\[Rule]", "\"\<*1.0/\>\""}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "[", "Answer", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"PyForm", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", "Answer", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Answer", " ", "=", " ", 
      RowBox[{"PythonForm", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"Return", "[", "Answer", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.787770465891507*^9, 3.787770504716734*^9}, {
  3.787770584072279*^9, 3.78777062288274*^9}, {3.787770874723768*^9, 
  3.787770969731165*^9}, {3.787785164971038*^9, 3.787785197405396*^9}, {
  3.787785234758821*^9, 3.7877852354133997`*^9}, {3.787785338494575*^9, 
  3.787785338733824*^9}, {3.7882064282803507`*^9, 3.788206442229093*^9}, {
  3.788206527839478*^9, 3.788206528053226*^9}, {3.788823861728278*^9, 
  3.788823876509564*^9}, {3.788903894971767*^9, 3.788903979799111*^9}, {
  3.7889044197574587`*^9, 3.788904429536158*^9}, {3.7889824820440607`*^9, 
  3.7889824994408703`*^9}, {3.7897595902485723`*^9, 3.789759626151661*^9}, {
  3.790370491320363*^9, 
  3.7903705036145267`*^9}},ExpressionUUID->"1183227b-7da4-4fcf-b70f-\
9bf89a24a935"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Miscellaneous methods\n",
 StyleBox["Tables, derivatives, simplifications",
  FontSize->16,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.779892815636361*^9, 3.7798928900844603`*^9}, {
   3.780329480784194*^9, 3.780329481743114*^9}, {3.7804180890383577`*^9, 
   3.7804180893510027`*^9}, 3.780676227972101*^9, {3.781085215500752*^9, 
   3.781085217044408*^9}, {3.781085276480856*^9, 3.781085286949916*^9}, {
   3.7810947625000267`*^9, 3.781094793044289*^9}, {3.781094920175769*^9, 
   3.7810949308885202`*^9}, {3.781300033468294*^9, 3.781300076833441*^9}, {
   3.785761308305621*^9, 
   3.78576133373533*^9}},ExpressionUUID->"fb7baf67-c61a-496b-bc38-\
62620253bd33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "list", " ", "of", " ", "derivatives", " ", "up", " ", "to",
     " ", "a", " ", "given", " ", "order"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Remove", "[", "TableD", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"TableD", "[", 
     RowBox[{"F_", ",", "var_", ",", 
      RowBox[{"order_:", "2"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Create", " ", "table", " ", "of", " ", "derivatives"}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"Ans", " ", "=", " ", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"F", ",", 
            RowBox[{"{", 
             RowBox[{"var", ",", 
              RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}], "\n", "\t\t\t\t", 
          ",", 
          RowBox[{"{", 
           RowBox[{"kkk", ",", 
            RowBox[{"order", "+", "1"}]}], "}"}]}], "\n", "\t\t\t", "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"(*", " ", 
     RowBox[{"Simplify", " ", "a", " ", "product", " ", "using", " ", "log"}],
      " ", "*)"}], "\n", 
    RowBox[{
     RowBox[{"Clear", "[", "LogSimplify", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LogSimplify", "[", 
       RowBox[{"X_", ",", 
        RowBox[{"XAssumptions_:", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"k", "\[GreaterEqual]", 
            RowBox[{"1", "/", "2"}]}], ",", 
           RowBox[{
            RowBox[{"Abs", "[", "m", "]"}], "\[LessEqual]", "k"}], ",", 
           RowBox[{"k", "\[GreaterEqual]", 
            RowBox[{"Abs", "[", "s", "]"}]}], ",", 
           RowBox[{"k", "\[Element]", "Integers"}], ",", 
           RowBox[{"m", "\[Element]", "Integers"}], ",", 
           RowBox[{"s", "\[Element]", "Integers"}]}], "}"}]}]}], "]"}], " ", ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", "\n", "\t\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "@", 
             RowBox[{"Expand", "@", 
              RowBox[{"PowerExpand", "[", 
               RowBox[{
                RowBox[{"Log", "[", "X", "]"}], ",", 
                RowBox[{"Assumptions", "\[Rule]", "XAssumptions"}]}], 
               "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "//.", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"Sqrt", "[", "a_", "]"}], 
                RowBox[{"Sqrt", "[", "b_", "]"}]}], "c_"], "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"Factor", "[", 
                 RowBox[{"a", " ", "b"}], "]"}], "]"}], "/", "c"}]}], "}"}]}],
            "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "//.", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["c_", 
              RowBox[{
               RowBox[{"Sqrt", "[", "a_", "]"}], 
               RowBox[{"Sqrt", "[", "b_", "]"}]}]], "\[RuleDelayed]", 
             RowBox[{"c", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Factor", "[", 
                RowBox[{"a", " ", "b"}], "]"}], "]"}]}]}], "}"}]}], "\n", 
          "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "//.", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["a_", 
             RowBox[{"b_", " ", 
              RowBox[{"Sqrt", "[", "c_", "]"}]}]], "\[RuleDelayed]", 
            FractionBox["a", 
             RowBox[{"b", " ", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Factor", "[", "c", "]"}], "]"}]}]]}], "}"}]}], "\n", 
         "\t\t\t\t", "]"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["a_", 
           RowBox[{"b_", " ", 
            RowBox[{"Sqrt", "[", "c_", "]"}]}]], "\[RuleDelayed]", 
          FractionBox["a", 
           RowBox[{"b", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Factor", "[", "c", "]"}], "]"}]}]]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["a_", "b_"], "\[RuleDelayed]", 
         FractionBox["a", 
          RowBox[{"Factor", "[", "b", "]"}]]}], "}"}]}]}]}], "*)"}], "\n", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"(*", " ", 
     RowBox[{"Log", " ", "simplify", " ", "multiple", " ", "terms"}], " ", 
     "*)"}], "\n", 
    RowBox[{
     RowBox[{"Remove", "[", "LogSimplify", "]"}], ";", "\n", 
     RowBox[{
      RowBox[{"LogSimplify", "[", 
       RowBox[{"X_", ",", 
        RowBox[{"XAssumptions_:", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"k", "\[GreaterEqual]", 
            RowBox[{"1", "/", "2"}]}], ",", 
           RowBox[{
            RowBox[{"Abs", "[", "m", "]"}], "\[LessEqual]", "k"}], ",", 
           RowBox[{"k", "\[GreaterEqual]", 
            RowBox[{"Abs", "[", "s", "]"}]}], ",", 
           RowBox[{"k", "\[Element]", "Integers"}], ",", 
           RowBox[{"m", "\[Element]", "Integers"}], ",", 
           RowBox[{"s", "\[Element]", "Integers"}]}], "}"}]}]}], "]"}], ":=", 
      " ", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"Return", " ", "Answer"}], " ", "*)"}], "\n", "\t", 
        RowBox[{"Return", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"PowerExpand", "[", 
            RowBox[{"X", ",", 
             RowBox[{"Assumptions", "\[Rule]", "XAssumptions"}]}], "]"}], 
           "\n", "\t\t", "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", "a_", "]"}], 
              RowBox[{"Sqrt", "[", "b_", "]"}]}], "\[RuleDelayed]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"a", " ", "b"}], "]"}]}], "}"}]}], "\n", "\t\t", "//.", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", "a_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"Factor", "[", "a", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "a_", "]"}]}], "\[RuleDelayed]", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Factor", "[", "a", "]"}], "]"}]}]}]}], "}"}]}], "\n", 
         "\t", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Log", " ", "simplify", " ", "multiple", " ", "terms"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "LogSimplify", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LogSimplify", "[", "X_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Return", " ", "Answer"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"Return", "[", "X", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\n", "\t\t\t\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Create", " ", "rule", " ", "to", " ", "replace", " ", "derivatives"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "MapRuleD", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"MapRuleD", "[", 
     RowBox[{"F_", ",", "G_", ",", "var_", ",", 
      RowBox[{"order_:", "2"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ans", ",", "kkk"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Create", " ", "table", " ", "of", " ", "derivatives"}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"Ans", " ", "=", " ", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t", 
         RowBox[{"(*", 
          RowBox[{"If", "[", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"G", "[", 
               RowBox[{"[", "0", "]"}], "]"}], "\[Equal]", "Sum"}], ")"}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Use", " ", "derivative", " ", "of", " ", "simple", " ", "sum"}],
              " ", "*)"}], "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"F", ",", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}], "\[Rule]", 
             RowBox[{"DerivativeOfSimpleSum", "[", 
              RowBox[{"G", ",", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}]}], "\n", 
            "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"Use", " ", "standard", " ", "derivative"}], " ", "*)"}],
             "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"F", ",", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}], "\[Rule]", 
             RowBox[{"D", "[", 
              RowBox[{"G", ",", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
           "\t\t\t\t", "]"}], "*)"}], "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"F", ",", 
             RowBox[{"{", 
              RowBox[{"var", ",", 
               RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}], "\[Rule]", 
           RowBox[{"D", "[", 
            RowBox[{"G", ",", 
             RowBox[{"{", 
              RowBox[{"var", ",", 
               RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}]}], "\n", 
          "\t\t\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"kkk", ",", 
            RowBox[{"order", "+", "1"}]}], "}"}]}], "\n", "\t\t\t", "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "coefficients", " ", "independently"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "CoeffSimplify", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CoeffSimplify", "[", 
     RowBox[{"F_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CollectedF", ",", "Ans"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Create", " ", "table", " ", "of", " ", "derivatives"}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"CollectedF", " ", "=", " ", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Simplify", "@", "F"}], ",", "vars"}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"Ans", " ", "=", " ", "CollectedF"}], ";", "\n", "\t", 
       RowBox[{"Table", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Ans", " ", "=", " ", 
           RowBox[{"Ans", "/.", 
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{"CollectedF", ",", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", "kkkk", "]"}], "]"}]}], "]"}], " ", 
              "\[RuleDelayed]", " ", 
              RowBox[{"Simplify", "[", 
               RowBox[{"Coefficient", "[", 
                RowBox[{"CollectedF", ",", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", "kkkk", "]"}], "]"}]}], "]"}], "]"}]}], "\n", 
             "\t\t\t\t\t", "}"}]}]}], ";"}], "\n", "\t\t", ",", 
         RowBox[{"{", 
          RowBox[{"kkkk", ",", 
           RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "\n", "\t", "]"}],
        ";", "\n", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "terms", " ", "independently"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "TermSimplify", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"TermSimplify", "[", "F_", "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Simplfy", " ", "each", " ", "Term"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"Ans", " ", "=", " ", 
        RowBox[{"Total", "[", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{"F", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "F", "]"}], "]"}]}], "}"}]}], " ", "]"}],
          " ", "]"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplfy", " ", "terms", " ", "independently"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "TermFullSimplify", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"TermFullSimplify", "[", "F_", "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Simplfy", " ", "each", " ", "Term"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"Ans", " ", "=", " ", 
        RowBox[{"Total", "[", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"FullSimplify", "[", 
            RowBox[{"F", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "F", "]"}], "]"}]}], "}"}]}], " ", "]"}],
          " ", "]"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"FullSimplfy", " ", "coefficients", " ", "independently"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "CoeffFullSimplify", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CoeffFullSimplify", "[", 
     RowBox[{"F_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CollectedF", ",", "Ans"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Create", " ", "table", " ", "of", " ", "derivatives"}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"CollectedF", " ", "=", " ", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Simplify", "@", "F"}], ",", "vars"}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"Ans", " ", "=", " ", "CollectedF"}], ";", "\n", "\t", 
       RowBox[{"Table", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Ans", " ", "=", " ", 
           RowBox[{"Ans", "/.", 
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{"CollectedF", ",", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", "kkkk", "]"}], "]"}]}], "]"}], " ", 
              "\[RuleDelayed]", " ", 
              RowBox[{"FullSimplify", "[", 
               RowBox[{"Coefficient", "[", 
                RowBox[{"CollectedF", ",", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", "kkkk", "]"}], "]"}]}], "]"}], "]"}]}], "\n", 
             "\t\t\t\t\t", "}"}]}]}], ";"}], "\n", "\t\t", ",", 
         RowBox[{"{", 
          RowBox[{"kkkk", ",", 
           RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "\n", "\t", "]"}],
        ";", "\n", "\t", 
       RowBox[{"Return", "[", "Ans", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"FullSimplfy", " ", "coefficients", " ", "independently"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "CollectSimplify", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CollectSimplify", "[", 
     RowBox[{"F_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Wrap", " ", "and", " ", "return"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{"CoeffSimplify", "[", 
         RowBox[{"F", ",", "vars"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"FullSimplfy", " ", "coefficients", " ", "independently"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "CollectFullSimplify", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CollectFullSimplify", "[", 
     RowBox[{"F_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Wrap", " ", "and", " ", "return"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"Return", "[", 
        RowBox[{"CoeffFullSimplify", "[", 
         RowBox[{"F", ",", "vars"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Commutator", " ", "for", " ", "methods", " ", "with", " ", "one", " ", 
     "input"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "Commutator", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Commutator", "[", 
     RowBox[{"A_", ",", "B_", ",", "Field_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", "Ans", "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Calculate", " ", "Commutator"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"Ans", " ", "=", " ", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"B", "[", "Field", "]"}], "]"}], " ", "-", " ", 
         RowBox[{"B", "[", 
          RowBox[{"A", "[", "Field", "]"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{"Simplify", "@", "Ans"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Linearize", " ", "Riccati", " ", "equation"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "RiccatiLinearize", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"RiccatiLinearize", "[", " ", 
     RowBox[{"L_", ",", " ", "f_", ",", "fNew_", ",", " ", "var_"}], " ", 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", "Internals", " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Answer", ",", "q2", ",", "q1", ",", "q0", ",", "q1d", ",", "c0", ",", 
        "u", ",", "Q0", ",", "Q1", ",", "Q2", ",", "L1", ",", "LinearizedL", 
        ",", "L3", ",", "\[Beta]Rule", ",", "\[Beta]"}], "}"}], ",", "\n", 
      "\t", 
      RowBox[{"(*", " ", "Shorthand", " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"u", " ", "=", " ", "var"}], ";", " ", 
       RowBox[{"\[Beta]", " ", "=", " ", "fNew"}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Initial", " ", "prefactors", " ", "of", " ", "interest"}], 
        " ", "*)"}], "\n", "\t", 
       RowBox[{"Q0", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "'"}], "[", "u", "]"}], ",", 
          RowBox[{"f", "[", "u", "]"}], ",", 
          SuperscriptBox[
           RowBox[{"f", "[", "u", "]"}], "2"]}], "}"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Collect", " ", "terms"}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1d", ",", "q1", ",", "q2"}], "}"}], " ", "=", " ", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"L", ",", "Q0"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Divide", " ", "by", " ", "derivate", " ", "coefficient", " ", "and", 
         " ", "recollect"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"L1", " ", "=", " ", 
        RowBox[{"CoeffSimplify", "[", 
         RowBox[{
          RowBox[{"L", "/", "q1d"}], ",", "Q0"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1d", ",", "q1", ",", "q2"}], "}"}], " ", "=", " ", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"L1", ",", "Q0"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Deterine", " ", "the", " ", "term", " ", "that", " ", "is", " ", 
         "not", " ", "proportial", " ", "to", " ", "a", " ", "memer", " ", 
         "of", " ", "Q0"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"q0", " ", "=", " ", 
        RowBox[{"Simplify", "[", 
         RowBox[{"L1", " ", "-", " ", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"q1d", ",", "q1", ",", "q2"}], "}"}], "Q0"}], "]"}]}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Define", " ", "the", " ", "linearizing", " ", "variable"}], 
        " ", "*)"}], "\n", "\t", 
       RowBox[{"\[Beta]Rule", " ", "=", " ", 
        RowBox[{"MapRuleD", "[", 
         RowBox[{
          RowBox[{"f", "[", "u", "]"}], ",", 
          RowBox[{
           FractionBox["1", "q2"], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"\[Beta]", "[", "u", "]"}], "]"}], ",", "u"}], "]"}]}], 
          ",", "u"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"LinearizedL", " ", "=", " ", 
        RowBox[{"CoeffSimplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Beta]", "[", "u", "]"}], " ", "L1"}], "/.", 
           "\[Beta]Rule"}], ",", 
          RowBox[{"TableD", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "u", "]"}], ",", "u"}], "]"}]}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"LinearizedL", " ", "=", " ", 
        RowBox[{"CoeffSimplify", "[", 
         RowBox[{
          RowBox[{"LinearizedL", "*", 
           RowBox[{"Denominator", "[", 
            RowBox[{"Coefficient", "[", 
             RowBox[{"LinearizedL", ",", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"\[Beta]", "[", "u", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"u", ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}]}], 
          ",", 
          RowBox[{"TableD", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "u", "]"}], ",", "u"}], "]"}]}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"Answer", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Beta]Rule", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "LinearizedL"}], "}"}]}], ";",
        "\n", "\t", 
       RowBox[{"Return", "[", "Answer", "]"}], ";"}]}], "\n", "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Method", " ", "to", " ", "compute", " ", "adjoint", " ", "of", " ", 
     "linear", " ", "differential", " ", "operator"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Remove", "[", "Adjoint", "]"}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{"Adjoint", "[", 
     RowBox[{"Df_", ",", "f_", ",", "var_", ",", 
      RowBox[{"assumptions_:", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"NoConj_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"Internal", " ", "variables"}], " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Answer", ",", "Coeffs", ",", "AdjCoeffs", ",", "ReducedDf", ",", 
        "TemplateConjCoeffs", ",", "TemplateAdjDf", ",", "QList", ",", 
        "AdjDf", ",", "zzz", ",", "kkkk", ",", "OrderD"}], "}"}], ",", "\n", 
      "\t", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"Make", " ", "template"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"OrderD", " ", "=", " ", 
        RowBox[{
         RowBox[{"MaxD", "[", 
          RowBox[{"Df", ",", "f", ",", "var"}], "]"}], "+", "1"}]}], ";", 
       "\n", "\t", 
       RowBox[{"ReducedDf", " ", "=", " ", 
        RowBox[{"CoeffSimplify", "[", 
         RowBox[{"Df", ",", 
          RowBox[{"TableD", "[", 
           RowBox[{"f", ",", "var", ",", 
            RowBox[{"OrderD", "-", "1"}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Df", "\[Equal]", "ReducedDf"}], "]"}]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Error\>\"", ",", 
            RowBox[{"Background", "\[Rule]", "Red"}]}], "]"}], "]"}]}], "]"}],
        ";", "\n", "\t", 
       RowBox[{"TemplateConjCoeffs", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<Q\>\"", " ", "<>", " ", 
             RowBox[{"ToString", "@", "kkkk"}]}], "]"}], "[", "var", "]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"kkkk", ",", " ", "OrderD"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", "\n", "\t", 
       RowBox[{"(*", "  ", "*)"}], "\n", "\t", 
       RowBox[{"Coeffs", " ", "=", " ", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"ReducedDf", ",", 
          RowBox[{"TableD", "[", 
           RowBox[{"f", ",", "var", ",", 
            RowBox[{"OrderD", "-", "1"}]}], "]"}]}], "]"}]}], ";", "\n", "\t",
        "\n", "\t", 
       RowBox[{"(*", "  ", "*)"}], "\n", "\t", 
       RowBox[{"TemplateAdjDf", " ", "=", " ", 
        RowBox[{"CoeffSimplify", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Sum", "[", " ", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], "zzz"], 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"TemplateConjCoeffs", "[", 
                  RowBox[{"[", 
                   RowBox[{"zzz", "+", "1"}], "]"}], "]"}], " ", "f"}], ",", 
                RowBox[{"{", 
                 RowBox[{"var", ",", "zzz"}], "}"}]}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\t\t\t\t\t    ", 
            RowBox[{"{", 
             RowBox[{"zzz", ",", "0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "TemplateConjCoeffs", "]"}], "-", 
               "1"}]}], "}"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"TableD", "[", 
           RowBox[{"f", ",", "var", ",", 
            RowBox[{"Length", "[", "Coeffs", "]"}]}], "]"}]}], "\n", "\t\t\t",
          "]"}]}], ";", "\n", "\t\t\t", "\n", "\t", 
       RowBox[{"(*", "  ", "*)"}], "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "TemplateConjCoeffs", "]"}], ";", "\n", "\t", 
         RowBox[{"Print", "[", "OrderD", "]"}], ";", "\n", "\t", 
         RowBox[{"Print", "[", 
          RowBox[{"TableD", "[", 
           RowBox[{"f", ",", "var", ",", 
            RowBox[{"OrderD", "-", "1"}]}], "]"}], "]"}], ";", "\n", "\t", 
         RowBox[{"Print", "[", 
          RowBox[{"Length", "[", "ReducedDf", "]"}], "]"}], ";", "\n", "\t", 
         RowBox[{"Print", "[", "ReducedDf", "]"}], ";", "\n", "\t", 
         RowBox[{"Print", "[", 
          RowBox[{"Length", "[", "TemplateConjCoeffs", "]"}], "]"}], ";", 
         "\n", "\t", 
         RowBox[{"Print", "[", 
          RowBox[{"Length", "[", "TemplateConjCoeffs", "]"}], "]"}], ";", 
         "\n", "\t", 
         RowBox[{"Print", "@", "Coeffs"}], ";", "\n", "\t", 
         RowBox[{"Print", "@", 
          RowBox[{"Length", "[", "Coeffs", "]"}]}], ";"}], "*)"}], "\n", 
       "\t\t\t", "\n", "\t", 
       RowBox[{"(*", "  ", "*)"}], "\n", "\t", 
       RowBox[{"AdjDf", " ", "=", " ", 
        RowBox[{"TemplateAdjDf", "\n", "\t\t\t\t\t\t", "/.", 
         RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t    ", 
          RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"MapRuleD", "[", 
             RowBox[{
              RowBox[{"TemplateConjCoeffs", "[", 
               RowBox[{"[", "kkkk", "]"}], "]"}], ",", 
              RowBox[{"Refine", "[", " ", 
               RowBox[{
                RowBox[{"Coeffs", "[", 
                 RowBox[{"[", "kkkk", "]"}], "]"}], ",", 
                RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], 
              ",", "var", ",", "OrderD"}], "]"}], ",", "\n", 
            "\t\t\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"kkkk", ",", 
              RowBox[{"Length", "[", "Coeffs", "]"}]}], "}"}]}], "\n", 
           "\t\t\t\t\t\t    ", "]"}], "\n", "\t\t\t\t\t\t  ", "]"}]}]}], ";", 
       "\n", "\t\t\t\t\t\t  ", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Handle", " ", "optional", " ", "conjugation", " ", "if", " ", 
         "reality", " ", "is", " ", "assumed"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"AdjCoeffs", " ", "=", " ", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"AdjDf", ",", 
          RowBox[{"TableD", "[", 
           RowBox[{"f", ",", "var", ",", "OrderD"}], "]"}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"AdjDf", " ", "=", " ", 
        RowBox[{"Total", "[", " ", 
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"f", ",", 
              RowBox[{"{", 
               RowBox[{"var", ",", 
                RowBox[{"kkk", "-", "1"}]}], "}"}]}], "]"}], " ", 
            RowBox[{"If", "[", 
             RowBox[{"NoConj", ",", 
              RowBox[{"AdjCoeffs", "[", 
               RowBox[{"[", "kkk", "]"}], "]"}], ",", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"AdjCoeffs", "[", 
                RowBox[{"[", "kkk", "]"}], "]"}], "]"}]}], "]"}]}], ",", " ", 
           
           RowBox[{"{", 
            RowBox[{"kkk", ",", 
             RowBox[{"Length", "[", "AdjCoeffs", "]"}]}], "}"}]}], " ", "]"}],
          " ", "]"}]}], ";", " ", "\n", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"Return", " ", "answer"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"Answer", " ", "=", " ", 
        RowBox[{"CoeffSimplify", "[", 
         RowBox[{"AdjDf", ",", 
          RowBox[{"TableD", "[", 
           RowBox[{"f", ",", "var", ",", 
            RowBox[{"Length", "[", "Coeffs", "]"}]}], "]"}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"Return", "[", "Answer", "]"}], ";"}]}], "\n", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.7857011597785597`*^9, 3.785701363918749*^9}, {
   3.7857013987934303`*^9, 3.785701407210493*^9}, {3.785761339725707*^9, 
   3.7857614682884893`*^9}, {3.78576155621245*^9, 3.785761597570486*^9}, {
   3.785764654398815*^9, 3.7857647927829447`*^9}, {3.785764922710928*^9, 
   3.7857650030062447`*^9}, {3.785765056551998*^9, 3.785765165749139*^9}, {
   3.7857655450633717`*^9, 3.785765576398736*^9}, {3.785765607795597*^9, 
   3.785765615836318*^9}, {3.7857665647994213`*^9, 3.785766699464426*^9}, 
   3.785770687091425*^9, {3.785783507502638*^9, 3.78578350802919*^9}, {
   3.785873985860021*^9, 3.7858740105587177`*^9}, 3.785874428896669*^9, {
   3.785875598125676*^9, 3.785875601985218*^9}, 3.786030009210376*^9, {
   3.786033895108123*^9, 3.7860339254990187`*^9}, {3.786034361585932*^9, 
   3.786034362297434*^9}, {3.78616705580308*^9, 3.786167069952924*^9}, {
   3.786167126949061*^9, 3.7861671690288353`*^9}, {3.786555120372835*^9, 
   3.786555129297996*^9}, {3.7884411354059563`*^9, 3.788441208125465*^9}, {
   3.7884412653090553`*^9, 3.788441286792615*^9}, {3.788441318318012*^9, 
   3.788441331741563*^9}, {3.7884414899980183`*^9, 3.788441493081306*^9}, {
   3.78877169912405*^9, 3.7887717170048027`*^9}, {3.788823881631734*^9, 
   3.7888239102333403`*^9}, {3.7888334167888737`*^9, 3.788833448199429*^9}, {
   3.788833766359765*^9, 3.788833767224041*^9}, 3.788833859984282*^9, {
   3.788834797601172*^9, 3.7888350067665854`*^9}, {3.788835082145463*^9, 
   3.788835082445931*^9}, {3.788835143394506*^9, 3.788835160474944*^9}, {
   3.7888609819871597`*^9, 3.788860982198615*^9}, {3.7888746146379833`*^9, 
   3.788874651574518*^9}, {3.7888747044992847`*^9, 3.78887484879781*^9}, {
   3.7888761042341547`*^9, 3.788876155630062*^9}, {3.78887778055935*^9, 
   3.788877831783184*^9}, 3.788878040260529*^9, {3.788878254900803*^9, 
   3.7888782701055*^9}, 3.788878357441296*^9, {3.788879354194511*^9, 
   3.7888793600074253`*^9}, 3.788880288998353*^9, {3.788880321361786*^9, 
   3.788880386243732*^9}, {3.788880430208387*^9, 3.7888804905203123`*^9}, {
   3.7888805668602867`*^9, 3.788880684265184*^9}, 3.788880777614566*^9, {
   3.788880849322413*^9, 3.788880886940222*^9}, {3.788880986058786*^9, 
   3.7888810326782093`*^9}, 3.788881123776719*^9, {3.788881930496038*^9, 
   3.78888193601059*^9}, {3.788882696659004*^9, 3.788882731731324*^9}, {
   3.788882850360972*^9, 3.788882961314014*^9}, {3.788883018163372*^9, 
   3.7888830400649157`*^9}, {3.788883071094751*^9, 3.788883090224495*^9}, {
   3.78888316775216*^9, 3.788883170387186*^9}, 3.788883386525916*^9, {
   3.78888956406371*^9, 3.7888895655995083`*^9}, {3.788889631783998*^9, 
   3.788889727231078*^9}, {3.7888897659763947`*^9, 3.788889771469768*^9}, {
   3.788889866031637*^9, 3.788889878747397*^9}, {3.7888899490216703`*^9, 
   3.7888900037135963`*^9}, {3.788892015659769*^9, 3.788892061152933*^9}, {
   3.78889209506714*^9, 3.788892143629237*^9}, {3.788899914394168*^9, 
   3.788899930071406*^9}, {3.788900056101232*^9, 3.788900071042584*^9}, {
   3.788900165938095*^9, 3.7889001672296457`*^9}, {3.7889009556072283`*^9, 
   3.788900978703577*^9}, {3.788901134513315*^9, 3.788901161407948*^9}, {
   3.788901230575974*^9, 3.788901243727673*^9}, {3.788901319721602*^9, 
   3.788901319979617*^9}, {3.7889060360706873`*^9, 3.788906066771696*^9}, {
   3.7889064369730673`*^9, 3.7889064396052313`*^9}, {3.7889066864825478`*^9, 
   3.788906757995961*^9}, {3.7889580986408253`*^9, 3.788958198068866*^9}, {
   3.788978694167615*^9, 3.788978703759595*^9}, {3.789394172520116*^9, 
   3.789394201349792*^9}, {3.789643010274181*^9, 3.789643077636702*^9}, 
   3.789643125053787*^9, {3.7896545117036123`*^9, 3.7896545133228273`*^9}, 
   3.789654647140373*^9, {3.789655061008275*^9, 3.789655086952941*^9}, {
   3.7897360935305843`*^9, 3.7897361402410707`*^9}, 3.789736227577215*^9, 
   3.7897362627148037`*^9, {3.789736312130653*^9, 3.789736482486948*^9}, {
   3.789736525266931*^9, 3.789736611453474*^9}, {3.789737778056576*^9, 
   3.7897378304813623`*^9}, {3.7897378633028717`*^9, 
   3.7897380957854013`*^9}, {3.789738169899301*^9, 3.789738169996323*^9}, {
   3.789738236960792*^9, 3.7897383302918653`*^9}, {3.789738418654121*^9, 
   3.7897384589557753`*^9}, {3.789738856966754*^9, 3.789738933232595*^9}, {
   3.789739016449538*^9, 3.789739037032127*^9}, {3.78973906922777*^9, 
   3.789739088290522*^9}, 3.7897391863372107`*^9, {3.789739250978712*^9, 
   3.789739300932682*^9}, {3.789745394461816*^9, 3.7897454429173393`*^9}, {
   3.789745474825425*^9, 3.7897454749677258`*^9}, {3.789745516269957*^9, 
   3.789745518951544*^9}, {3.789745587332101*^9, 3.789745606867772*^9}, {
   3.789745644084771*^9, 3.789745656908451*^9}, {3.789745710494637*^9, 
   3.78974575207885*^9}, {3.789745784180805*^9, 3.7897458456464157`*^9}, {
   3.789747405023383*^9, 3.7897474449973717`*^9}, {3.7897476794565773`*^9, 
   3.7897476825259733`*^9}, 3.789747723968831*^9, {3.789747801461595*^9, 
   3.789747802326932*^9}, {3.789747834564548*^9, 3.7897478417933683`*^9}, {
   3.789747878847324*^9, 3.7897479015185204`*^9}, {3.7897495405490522`*^9, 
   3.7897495617288847`*^9}, {3.789749608325109*^9, 3.7897496086443167`*^9}, 
   3.78974966831255*^9, {3.789751741303974*^9, 3.789751741892194*^9}, {
   3.789755110587742*^9, 3.789755111897862*^9}, {3.831051945893338*^9, 
   3.8310519560827227`*^9}, {3.831051993378001*^9, 3.831052066189028*^9}, {
   3.831053851658329*^9, 
   3.8310538613931837`*^9}},ExpressionUUID->"254981b8-a564-4b9b-bc7c-\
7b7cb2afd864"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["End Package",
 FontColor->GrayLevel[0.5]]], "Chapter",
 CellChangeTimes->{{3.781092222670632*^9, 3.781092248364132*^9}, {
  3.781092310240068*^9, 3.7810923130316143`*^9}, {3.781094566171309*^9, 
  3.781094567112204*^9}},ExpressionUUID->"b64d0d81-8ac0-46a6-8c51-\
be8b30c10fc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"End", "[", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"End", " ", "Private"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6947644301622267`*^9, 3.694764432551149*^9}, {
  3.781107766642096*^9, 
  3.781107771541881*^9}},ExpressionUUID->"80b8d364-e79a-4043-9e23-\
df9410d04e5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Chapter",
 CellChangeTimes->{{3.781092222670632*^9, 3.781092248364132*^9}, {
  3.781092310240068*^9, 3.7810923130316143`*^9}, {3.781094566171309*^9, 
  3.781094567112204*^9}, {3.781096979506721*^9, 
  3.781096980609591*^9}},ExpressionUUID->"5816dc44-10f8-47e8-a056-\
eb1279362ed7"],

Cell[CellGroupData[{

Cell[TextData[{
 "Example A -- Find the Singular Exponents of Teukolsky' s angular equation \n\
",
 StyleBox["with DeriveIndicialSolutions",
  FontColor->GrayLevel[0.5]]
}], "Subsection",
 CellChangeTimes->{{3.781098027538204*^9, 3.781098080435319*^9}, {
  3.781110009264702*^9, 
  3.78111001336792*^9}},ExpressionUUID->"be2d7de7-72ef-485f-a526-\
de98117b1dac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Import", " ", "the", " ", "Package"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"<<", "PositiveMMA.m"}]}]], "Input",
 CellChangeTimes->{{3.694764440004158*^9, 3.694764444111925*^9}, {
   3.6963280585780773`*^9, 3.696328058626683*^9}, {3.7810970275141487`*^9, 
   3.781097030728922*^9}, 3.78109711258856*^9, {3.781098011185892*^9, 
   3.781098020738538*^9}},ExpressionUUID->"b574ea37-509e-4cc4-92d9-\
c9d8332309ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", 
    RowBox[{"Teukolsky", "'"}], "s", " ", "angular", " ", "equation"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DS", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Alm", "+", "s", "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"m", "+", 
            RowBox[{"s", " ", "u"}]}], ")"}], "2"], 
         RowBox[{"1", "-", 
          SuperscriptBox["u", "2"]}]], "-", 
        RowBox[{"2", " ", "s", " ", "u", " ", "\[Gamma]"}], "+", 
        RowBox[{
         SuperscriptBox["u", "2"], " ", 
         SuperscriptBox["\[Gamma]", "2"]}]}], ")"}], " ", 
      RowBox[{"S", "[", "u", "]"}]}], "-", 
     RowBox[{"2", " ", "u", " ", 
      RowBox[{
       SuperscriptBox["S", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["u", "2"]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["S", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.781098085792469*^9, 3.781098085819004*^9}, {
   3.78109813232307*^9, 3.781098148258576*^9}, 
   3.7810984301391172`*^9},ExpressionUUID->"d08475e5-8e7f-4e67-8dd2-\
99918b3b6343"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Usa", " ", "a", " ", "package", " ", "function", " ", "to", " ", 
    "determine", " ", "the", " ", "singular", " ", "exponents"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"SingularExponents", ",", "SolutionAnsatz"}], "}"}], " ", "=", 
    " ", 
    RowBox[{"DeriveIndicialSolutions", "[", 
     RowBox[{"DS", ",", "S", ",", "u", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.781098151941427*^9, 3.781098190842678*^9}, {
   3.781098340477199*^9, 3.7810983575956507`*^9}, 3.781098441124753*^9, {
   3.781098604197978*^9, 3.78109860813678*^9}, {3.781098651920939*^9, 
   3.781098657855145*^9}, {3.7810990262042837`*^9, 
   3.781099027175795*^9}},ExpressionUUID->"daf98fe4-3e95-46a0-a497-\
78b6997bf455"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "two", " ", "solutions", " ", "for", " ", "each", " ", 
    "exponent", " ", "relate", " ", "to", " ", "the", " ", "two", " ", 
    "solutions", " ", "of", " ", "the", " ", "2", "nd", " ", "order", " ", 
    "differential", " ", "equation"}], " ", "*)"}], "\[IndentingNewLine]", 
  "SingularExponents"}]], "Input",
 CellChangeTimes->{{3.781098449972776*^9, 3.781098452683443*^9}, {
  3.781098498598344*^9, 
  3.781098530862397*^9}},ExpressionUUID->"5dafdcd7-9994-48ff-9aa6-\
e01dc82878bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", "\[Rule]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "m"}], "-", "s"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", "\[Rule]", 
       FractionBox[
        RowBox[{"m", "+", "s"}], "2"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k2", "\[Rule]", 
       FractionBox[
        RowBox[{"m", "-", "s"}], "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", "\[Rule]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "m"}], "+", "s"}], ")"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.781098464901248*^9, 3.781098683152069*^9, {3.781098767957039*^9, 
   3.781098781397749*^9}, {3.781098848523864*^9, 3.781098853503262*^9}, {
   3.781098891935195*^9, 3.7810988990544643`*^9}, 3.781099048787778*^9, 
   3.781107748569647*^9, 3.781110268770411*^9, 3.78111121072965*^9, {
   3.7811112500025187`*^9, 3.781111273264326*^9}, {3.781111312477888*^9, 
   3.781111321412801*^9}, 3.781111374657269*^9, 3.78111146817408*^9, 
   3.781111508138381*^9},ExpressionUUID->"6a9bcfd2-a727-4bdd-9ebb-\
8d2be0204028"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "A", " ", "solution", " ", "of", " ", "DS", " ", "will", " ", "have", " ",
      "this", " ", "overall", " ", "scaling", " ", "determined", " ", "by", 
     " ", "the", " ", "singular", " ", "exponents", " ", "multiplied", " ", 
     "by", " ", "a", " ", "function", " ", "of", " ", "u"}], ",", " ", 
    RowBox[{"f", "[", "u", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "SolutionAnsatz"}]], "Input",
 CellChangeTimes->{{3.781098534142014*^9, 3.781098553461238*^9}, {
  3.781098707717177*^9, 3.7810987410901947`*^9}, {3.7810989647613497`*^9, 
  3.781098996734941*^9}, {3.7810990294555607`*^9, 
  3.7810990307593412`*^9}},ExpressionUUID->"90dbb155-968a-417b-8245-\
a200ad1a31d1"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "u"}], ")"}], "k1"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", "u"}], ")"}], "k2"], " ", 
  RowBox[{"f", "[", "u", "]"}]}]], "Output",
 CellChangeTimes->{
  3.781098466247355*^9, 3.781098683194826*^9, {3.7810987425019913`*^9, 
   3.781098781451338*^9}, {3.781098848568201*^9, 3.7810988535471992`*^9}, {
   3.781098892068445*^9, 3.781098899082815*^9}, 3.7810990488353148`*^9, 
   3.7811077486127653`*^9, 3.781110268803265*^9, 3.781111210774495*^9, {
   3.781111250048901*^9, 3.7811112732974243`*^9}, {3.781111312536078*^9, 
   3.781111321475292*^9}, 3.781111374700102*^9, 3.7811114682042923`*^9, 
   3.7811115081764174`*^9},ExpressionUUID->"e1b20d64-9578-4c36-81be-\
d34e7749ab6b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Example B -- Find the Singular Exponents of Teukolsky' s angular equation \n\
",
 StyleBox["with DeriveIndicialSolutions2",
  FontColor->GrayLevel[0.5]]
}], "Subsection",
 CellChangeTimes->{{3.781098027538204*^9, 3.781098080435319*^9}, {
  3.781110009264702*^9, 
  3.781110036796571*^9}},ExpressionUUID->"84519520-ad6e-4619-9f89-\
50a1907891cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Import", " ", "the", " ", "Package"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"<<", "PositiveMMA.m"}]}]], "Input",
 CellChangeTimes->{{3.694764440004158*^9, 3.694764444111925*^9}, {
   3.6963280585780773`*^9, 3.696328058626683*^9}, {3.7810970275141487`*^9, 
   3.781097030728922*^9}, 3.78109711258856*^9, {3.781098011185892*^9, 
   3.781098020738538*^9}},ExpressionUUID->"0dfb72fc-609c-4581-8067-\
4fb49b347e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", 
    RowBox[{"Teukolsky", "'"}], "s", " ", "angular", " ", "equation"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "u"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C1", " ", "=", " ", 
     RowBox[{"Alm", "+", "s", "-", 
      RowBox[{"2", " ", "s", " ", "u", " ", "\[Gamma]"}], "+", 
      RowBox[{
       SuperscriptBox["u", "2"], " ", 
       SuperscriptBox["\[Gamma]", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C2", " ", "=", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m", "+", 
        RowBox[{"s", " ", "u"}]}], ")"}], "2"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DyFunctions", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{"A", ",", "B", ",", "C1", ",", "C2"}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.781098085792469*^9, 3.781098085819004*^9}, {
   3.78109813232307*^9, 3.781098148258576*^9}, 3.7810984301391172`*^9, {
   3.781110081174405*^9, 3.7811102111258173`*^9}, 3.781110628749584*^9, {
   3.7811112361675386`*^9, 3.781111238461941*^9}, {3.781111483222643*^9, 
   3.781111492451603*^9}},ExpressionUUID->"01d752f1-0c4a-4807-831d-\
67fbe39a140c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Usa", " ", "a", " ", "package", " ", "function", " ", "to", " ", 
    "determine", " ", "the", " ", "singular", " ", "exponents"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"SingularExponents2", ",", "SolutionAnsatz2"}], "}"}], " ", "=", 
   " ", 
   RowBox[{"DeriveIndicialSolutions2", "[", 
    RowBox[{"DyFunctions", ",", "S", ",", "u", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.781098151941427*^9, 3.781098190842678*^9}, {
   3.781098340477199*^9, 3.7810983575956507`*^9}, 3.781098441124753*^9, {
   3.781098604197978*^9, 3.78109860813678*^9}, {3.781098651920939*^9, 
   3.781098657855145*^9}, {3.7810990262042837`*^9, 3.781099027175795*^9}, {
   3.7811102309702597`*^9, 3.781110257492535*^9}, 3.78111031493673*^9, {
   3.781110529696269*^9, 3.7811105670130243`*^9}, {3.781111501456703*^9, 
   3.781111502469393*^9}},ExpressionUUID->"17799da2-4026-45cd-aaeb-\
02ed28e1d9c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", "\[Rule]", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "m"}], "-", "s"}], ")"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", "\[Rule]", 
         FractionBox[
          RowBox[{"m", "+", "s"}], "2"]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", "\[Rule]", 
         FractionBox[
          RowBox[{"m", "-", "s"}], "2"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2", "\[Rule]", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "m"}], "+", "s"}], ")"}]}]}], "}"}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "u"}], ")"}], "k1"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "u"}], ")"}], "k2"], " ", 
    RowBox[{"f", "[", "u", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.781110530329043*^9, 3.781110567788968*^9}, 
   3.7811106416391363`*^9, 3.781110749930011*^9, {3.781110781338374*^9, 
   3.781110799395974*^9}, 3.781110842409093*^9, 3.7811109738136053`*^9, 
   3.781111085513741*^9, {3.781111198219399*^9, 3.7811112109815474`*^9}, {
   3.781111240999875*^9, 3.7811112735620737`*^9}, {3.781111312742362*^9, 
   3.78111132167382*^9}, 3.781111374960421*^9, 3.7811114076586933`*^9, {
   3.781111468584272*^9, 
   3.781111508262705*^9}},ExpressionUUID->"cece90dd-a450-4b8e-baf1-\
341852a71a29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "two", " ", "solutions", " ", "for", " ", "each", " ", 
    "exponent", " ", "relate", " ", "to", " ", "the", " ", "two", " ", 
    "solutions", " ", "of", " ", "the", " ", "2", "nd", " ", "order", " ", 
    "differential", " ", "equation"}], " ", "*)"}], "\[IndentingNewLine]", 
  "SingularExponents2"}]], "Input",
 CellChangeTimes->{{3.781098449972776*^9, 3.781098452683443*^9}, {
   3.781098498598344*^9, 3.781098530862397*^9}, 
   3.781111504214136*^9},ExpressionUUID->"4afa7004-780c-4306-b5e6-\
359d3484c6d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", "\[Rule]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "m"}], "-", "s"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k1", "\[Rule]", 
       FractionBox[
        RowBox[{"m", "+", "s"}], "2"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k2", "\[Rule]", 
       FractionBox[
        RowBox[{"m", "-", "s"}], "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", "\[Rule]", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "m"}], "+", "s"}], ")"}]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.781098464901248*^9, 3.781098683152069*^9, {3.781098767957039*^9, 
   3.781098781397749*^9}, {3.781098848523864*^9, 3.781098853503262*^9}, {
   3.781098891935195*^9, 3.7810988990544643`*^9}, 3.781099048787778*^9, 
   3.781107748569647*^9, 3.781110269086629*^9, 3.781111211036648*^9, {
   3.781111250299287*^9, 3.781111273671112*^9}, {3.781111312791706*^9, 
   3.7811113217252274`*^9}, 3.78111137503825*^9, {3.781111468622776*^9, 
   3.7811115083245707`*^9}},ExpressionUUID->"ee9e7e6c-e08e-482b-8eca-\
905682e3c155"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "A", " ", "solution", " ", "of", " ", "DS", " ", "will", " ", "have", " ",
      "this", " ", "overall", " ", "scaling", " ", "determined", " ", "by", 
     " ", "the", " ", "singular", " ", "exponents", " ", "multiplied", " ", 
     "by", " ", "a", " ", "function", " ", "of", " ", "u"}], ",", " ", 
    RowBox[{"f", "[", "u", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "SolutionAnsatz2"}]], "Input",
 CellChangeTimes->{{3.781098534142014*^9, 3.781098553461238*^9}, {
   3.781098707717177*^9, 3.7810987410901947`*^9}, {3.7810989647613497`*^9, 
   3.781098996734941*^9}, {3.7810990294555607`*^9, 3.7810990307593412`*^9}, 
   3.78111150494156*^9},ExpressionUUID->"5a861781-2e73-4d59-8c2f-\
3778fa37b9bb"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "u"}], ")"}], "k1"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", "u"}], ")"}], "k2"], " ", 
  RowBox[{"f", "[", "u", "]"}]}]], "Output",
 CellChangeTimes->{
  3.781098466247355*^9, 3.781098683194826*^9, {3.7810987425019913`*^9, 
   3.781098781451338*^9}, {3.781098848568201*^9, 3.7810988535471992`*^9}, {
   3.781098892068445*^9, 3.781098899082815*^9}, 3.7810990488353148`*^9, 
   3.7811077486127653`*^9, 3.781110269152431*^9, 3.781111211102244*^9, {
   3.7811112503549023`*^9, 3.781111273923106*^9}, {3.781111312841114*^9, 
   3.781111321771801*^9}, 3.781111375140674*^9, {3.781111468673592*^9, 
   3.781111508385305*^9}},ExpressionUUID->"9cb801d7-1b9d-4e48-a705-\
adf31203cef8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compare", " ", "DeriveIndicialSolutions", " ", "Methods"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DS", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Alm", "+", "s", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"m", "+", 
             RowBox[{"s", " ", "u"}]}], ")"}], "2"], 
          RowBox[{"1", "-", 
           SuperscriptBox["u", "2"]}]], "-", 
         RowBox[{"2", " ", "s", " ", "u", " ", "\[Gamma]"}], "+", 
         RowBox[{
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["\[Gamma]", "2"]}]}], ")"}], " ", 
       RowBox[{"S", "[", "u", "]"}]}], "-", 
      RowBox[{"2", " ", "u", " ", 
       RowBox[{
        SuperscriptBox["S", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["u", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["S", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DeriveIndicialSolutions", "[", 
      RowBox[{"DS", ",", "S", ",", "u", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "==", 
     RowBox[{"DeriveIndicialSolutions2", "[", 
      RowBox[{"DyFunctions", ",", "S", ",", "u", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.781111520719022*^9, 3.7811115270072317`*^9}, {
  3.7811115602610617`*^9, 
  3.781111584360627*^9}},ExpressionUUID->"773ef5fb-ece8-415e-8d1a-\
e74ac3204802"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.781111531774631*^9, 
  3.78111158699454*^9},ExpressionUUID->"da4ccd30-0f64-40b4-982d-a5a16449431c"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1059, 651},
WindowMargins->{{-1150, Automatic}, {Automatic, 36}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 498, 13, 152, "Title",ExpressionUUID->"72372150-d4c7-42ff-8392-b19d75a3df08"],
Cell[1081, 37, 481, 11, 30, "Input",ExpressionUUID->"3d04a2db-c585-49de-a815-9a3562c22593"],
Cell[CellGroupData[{
Cell[1587, 52, 257, 5, 69, "Chapter",ExpressionUUID->"07fa5e09-6acf-47bd-b176-7a9735c3d040"],
Cell[1847, 59, 429, 9, 52, "Input",ExpressionUUID->"b36b63d5-7fbf-4913-b87d-9f1d2673f37d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2313, 73, 254, 4, 69, "Chapter",ExpressionUUID->"c3781337-bd75-44a2-9656-1a88b4a2aaa2"],
Cell[CellGroupData[{
Cell[2592, 81, 387, 11, 71, "Subsubsection",ExpressionUUID->"dcf14dd2-e66a-4719-9a9e-599c627b0684"],
Cell[2982, 94, 8510, 197, 1260, "Code",ExpressionUUID->"16c5df31-db2a-44d9-93b4-ebd4591b3b4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11529, 296, 479, 7, 45, "Subsubsection",ExpressionUUID->"833555dd-19bc-40f6-9291-07bcbdc947ab"],
Cell[12011, 305, 1971, 47, 338, "Code",ExpressionUUID->"9b8b48ec-9a5a-4fbc-b402-6d58d1a95d27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14019, 357, 431, 6, 45, "Subsubsection",ExpressionUUID->"f1734a01-a6e4-40c1-8212-bd4f12f06e75"],
Cell[14453, 365, 4838, 110, 566, "Code",ExpressionUUID->"3d39f39d-97e2-4e24-bb4c-2d424448d601"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19328, 480, 393, 11, 71, "Subsubsection",ExpressionUUID->"ceaff881-3ce5-4412-8f2d-ac5488657115"],
Cell[19724, 493, 16379, 384, 1697, "Code",ExpressionUUID->"8b7f6a42-345a-4a43-9032-4ff4c8235c69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36140, 882, 667, 13, 67, "Subsubsection",ExpressionUUID->"04528f97-b046-47bc-8df6-6764c783d45f"],
Cell[36810, 897, 10239, 223, 1062, "Code",ExpressionUUID->"4162d819-5a67-484b-afa7-1f25f25369ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47086, 1125, 735, 13, 93, "Subsubsection",ExpressionUUID->"62dc2d50-452c-41f9-8ddb-d9bd0e6a7bd8"],
Cell[47824, 1140, 13738, 311, 1819, "Code",ExpressionUUID->"4d4f4b0a-5c81-4d62-b355-af83b820b66e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61599, 1456, 361, 9, 67, "Subsubsection",ExpressionUUID->"e33c1268-3682-417e-8027-e9b0c5785118"],
Cell[61963, 1467, 6899, 170, 737, "Code",ExpressionUUID->"1183227b-7da4-4fcf-b70f-9bf89a24a935"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68899, 1642, 709, 14, 67, "Subsubsection",ExpressionUUID->"fb7baf67-c61a-496b-bc38-62620253bd33"],
Cell[69611, 1658, 37162, 853, 4188, "Code",ExpressionUUID->"254981b8-a564-4b9b-bc7c-7b7cb2afd864"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106822, 2517, 301, 5, 69, "Chapter",ExpressionUUID->"b64d0d81-8ac0-46a6-8c51-be8b30c10fc0"],
Cell[107126, 2524, 399, 11, 54, "Input",ExpressionUUID->"80b8d364-e79a-4043-9e23-df9410d04e5b"]
}, Closed]],
Cell[CellGroupData[{
Cell[107562, 2540, 299, 5, 58, "Chapter",ExpressionUUID->"5816dc44-10f8-47e8-a056-eb1279362ed7"],
Cell[CellGroupData[{
Cell[107886, 2549, 361, 9, 81, "Subsection",ExpressionUUID->"be2d7de7-72ef-485f-a526-de98117b1dac"],
Cell[108250, 2560, 481, 10, 52, "Input",ExpressionUUID->"b574ea37-509e-4cc4-92d9-c9d8332309ad"],
Cell[108734, 2572, 1361, 38, 76, "Input",ExpressionUUID->"d08475e5-8e7f-4e67-8dd2-99918b3b6343"],
Cell[110098, 2612, 912, 22, 52, "Input",ExpressionUUID->"daf98fe4-3e95-46a0-a497-78b6997bf455"],
Cell[CellGroupData[{
Cell[111035, 2638, 562, 12, 52, "Input",ExpressionUUID->"5dafdcd7-9994-48ff-9aa6-e01dc82878bc"],
Cell[111600, 2652, 1338, 38, 50, "Output",ExpressionUUID->"6a9bcfd2-a727-4bdd-9ebb-8d2be0204028"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112975, 2695, 758, 15, 73, "Input",ExpressionUUID->"90dbb155-968a-417b-8245-a200ad1a31d1"],
Cell[113736, 2712, 803, 18, 35, "Output",ExpressionUUID->"e1b20d64-9578-4c36-81be-d34e7749ab6b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114588, 2736, 363, 9, 81, "Subsection",ExpressionUUID->"84519520-ad6e-4619-9f89-50a1907891cb"],
Cell[114954, 2747, 481, 10, 54, "Input",ExpressionUUID->"0dfb72fc-609c-4581-8067-4fb49b347e1e"],
Cell[115438, 2759, 1443, 38, 138, "Input",ExpressionUUID->"01d752f1-0c4a-4807-831d-67fbe39a140c"],
Cell[CellGroupData[{
Cell[116906, 2801, 1068, 23, 54, "Input",ExpressionUUID->"17799da2-4026-45cd-aaeb-02ed28e1d9c0"],
Cell[117977, 2826, 1698, 49, 48, "Output",ExpressionUUID->"cece90dd-a450-4b8e-baf1-341852a71a29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119712, 2880, 587, 12, 54, "Input",ExpressionUUID->"4afa7004-780c-4306-b5e6-359d3484c6d8"],
Cell[120302, 2894, 1343, 38, 48, "Output",ExpressionUUID->"ee9e7e6c-e08e-482b-8eca-905682e3c155"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121682, 2937, 783, 15, 54, "Input",ExpressionUUID->"5a861781-2e73-4d59-8c2f-3778fa37b9bb"],
Cell[122468, 2954, 801, 18, 33, "Output",ExpressionUUID->"9cb801d7-1b9d-4e48-a705-adf31203cef8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123306, 2977, 1825, 51, 101, "Input",ExpressionUUID->"773ef5fb-ece8-415e-8d1a-e74ac3204802"],
Cell[125134, 3030, 152, 2, 32, "Output",ExpressionUUID->"da4ccd30-0f64-40b4-982d-a5a16449431c"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

